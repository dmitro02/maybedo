{"version":3,"sources":["classes/Task.ts","components/Fog/Fog.tsx","components/Statuses/Spinner.tsx","utils/localStorageUtils.ts","utils/commonUtils.ts","classes/Syncer.ts","classes/Metadata.ts","utils/taskService.ts","classes/DropboxClient.ts","classes/DropboxConnector.ts","components/Statuses/SyncStatus.tsx","classes/Store.ts","components/Banner/Banner.tsx","classes/StoreFactory.ts","components/Statuses/Loading.tsx","utils/customHooks.ts","components/Record/AddRecord.tsx","components/Buttons/CheckmarkButton.tsx","components/RecordMenu/DeleteRecords.tsx","components/RecordMenu/Priority.tsx","components/RecordMenu/AddSubtask.tsx","components/RecordMenu/RecordMenu.tsx","components/Record/Editable.tsx","components/Record/Record.tsx","components/RecordList/RecordList.tsx","components/Sidebar/Sidebar.tsx","components/Settings/ExportImport.tsx","components/Buttons/MenuButton.tsx","HOCs/Portal.tsx","HOCs/withModal.tsx","components/Buttons/Button.tsx","components/Settings/ImportModal.tsx","components/Settings/DropboxSettings.tsx","components/Settings/SyncSettings.tsx","components/Settings/Settings.tsx","components/MainContainer/Content.tsx","components/MainContainer/MainContainer.tsx","App.tsx","serviceWorkerRegistration.ts","index.tsx"],"names":["Priorities","Fog","props","isDisplayed","className","style","display","Spinner","customClass","METADATA_KEY","SELECTED_PROJECT_ID_KEY","SETTINGS_KEY","TOKENS_KEY","hasItem","key","localStorage","getItem","getObject","JSON","parse","setObject","obj","setItem","stringify","setSelectedProjectId","id","getSettings","getSyncTarget","syncTarget","setSyncTarget","getTokens","setDropboxToken","dropboxAccessToken","readFile","blob","Promise","resolve","reject","fr","FileReader","onerror","onload","result","readAsText","generateId","length","Math","floor","random","toString","substring","SyncTargets","Task","text","isDone","priority","updatedAt","parentId","subTasks","Trivial","Date","now","this","ROOT_ID","Metadata","taskList","created","deleted","updated","item","p","u","push","includes","filter","it","addToTaskList","addToCreated","save","removeFromTaskList","removeFromCreated","addToDeleted","getAllTaskIds","reduce","acc","curr","Object","values","some","taskId","taskMetaRecord","keys","metadata","lsUtils","restore","hasRoot","getTask","getTaskList","taskIds","getSubTasksList","childrenIds","getChildrenIds","getTasksTree","root","addSubTasks","parent","forEach","task","updateTask","registerUpdated","createTask","registerCreated","createTasks","tasks","deleteTask","isProject","store","selectedProjectId","removeItem","registerDeleted","TOKEN_URL","DropboxClient","clientId","codeVerifier","dropbox","initDropbox","validateConfiguration","checkUser","query","authorizationCode","body","URLSearchParams","code","grant_type","client_id","code_verifier","fetch","method","headers","response","json","resData","ok","Error","error_description","accessToken","access_token","path","filesListFolder","filesDownload","contents","filesUpload","mode","filesDeleteV2","token","Dropbox","DATA_FOLDER_PATH","METADATA_FILE_PATH","DropboxConnector","dropboxClient","authorize","check","names","files","name","downloadFile","fileBlob","fileContent","file","uploadFile","deleteFile","authUrl","isConfigured","SyncStatuses","syncer","cloudConnector","isSyncFaild","interval","processChanges","local","remote","localList","remoteList","hasOwnProperty","remoteUpdatedAt","localUpdatedAt","addToUpdated","syncChanges","a","toDownload","concat","toUpload","toDeleteLocal","toDeleteRemote","needToUpdateRemote","needToUpdateLocal","downloadItems","items","taskService","filesToUpload","map","uploadItems","deleteItems","reset","reload","uploadRemoteMeta","metaLocal","Disabled","createCloudConnector","clearInterval","sync","setInterval","bind","syncStatus","InProgress","fetchRemoteMeta","metaRemote","console","error","Failure","Idle","message","toLowerCase","NotConfigured","downloadMetadata","taskListStr","uploadMetadata","SyncStatus","usePropertyWithState","status","refresh","baseClass","noHoverClass","title","onClick","getStatusElement","init","initRoot","BannerTypes","initSelectProjectId","getProjectsList","initialValue","subsciptions","Map","notify","property","value","get","callback","Proxy","set","target","useSubscribe","eventOrProperty","useEffect","callbacks","subscribe","newCallbacks","unsubscribe","useEvent","eventName","useProperty","useEventWithState","useState","state","setState","useReload","createStore","showLoading","banner","Loading","spinnerClass","useOutsideClickDetector","ref","action","isEnabled","handleClickOutside","e","current","contains","document","addEventListener","removeEventListener","AddRecord","add","contentEditable","suppressContentEditableWarning","onInput","textContent","trim","onKeyPress","preventEnterOnEmpty","preventDefault","memo","CheckmarkButton","actionOnClick","isChecked","classes","join","DeleteRecords","isBulk","isDisabled","closeMenu","remove","showDeleteConfirmation","setShowDeleteConfirmation","closeDeleteConfirmation","stopPropagation","confirmRef","useRef","configSingle","icon","tooltip","deleteAction","configBulk","classNames","PRIORITY_NAMES","Minor","Normal","Major","Critical","undefined","Priority","update","showSelector","setShowSelector","switchRef","el","newPrio","parseInt","AddSubtask","showSubtasks","RecordMenu","closeTimeout","isRoot","showMenu","setShowMenu","menuRef","onMouseLeave","setTimeout","onMouseEnter","clearTimeout","debounceInput","timeout","innerText","getCaretPosition","isContentEditable","range","getSelection","getRangeAt","err","rangeClone","cloneRange","selectNodeContents","setEnd","endContainer","endOffset","setCaretPosition","pos","createRange","selection","window","elContentNode","childNodes","textLength","positionNormalized","min","setStart","collapse","removeAllRanges","addRange","Editable","isEditable","getFocus","editableRef","caretPosRef","setContentEditable","focus","activeElement","flag","setAttribute","handleInput","endsWith","onBlur","Record","isTitle","isSelected","isFocused","hasSubtasks","hasChildren","setShowSubtasks","setText","updateTitle","recordClassName","hiddenBtnClassName","iAmRunningOnMobile","openSubtasks","closeSubtasks","button","replace","getSubtasksBtn","rootId","RecordList","hasTitle","projectId","setRoot","setSubTasks","setData","focusedItemId","isRootList","addSubTask","useCallback","newSubTasks","updateSubTask","deleteSubTask","isSelectedPojectDeleted","deleteCompletedSubTask","idsToDelete","sort","b","pa","pb","activeTasks","t","completedTasks","activeItemListRef","Sidebar","isOpened","close","isSettingsOpened","leftPanelRef","getAttribute","Banner","setBanner","delay","type","DataTypes","FailureBanner","SuccessBanner","Success","MenuButton","Portal","children","mountPoint","getElementById","createElement","appendChild","removeChild","createPortal","withModal","WrapedComponent","Button","isOutlined","forwardRef","onConfirm","onCancel","cancelRef","doExport","data","dataToExport","encodedUri","encodeURI","link","getExportFileName","click","exportDataAsJson","convertDataToJsonString","exportDataAsHtml","taskTree","content","convertDataToHtmlString","HTML","timestamp","toISOString","textDecoration","subTasksHtml","ExportImport","showModal","setShowModal","backToTaskList","fileInputRef","dataType","doImport","clearFileInput","onChange","toUpperCase","accept","DropboxSettings","dbx","authTokenRef","authorizeApp","open","size","placeholder","SyncSettings","setSynStatus","isSelectDisabled","disabled","getTargetSettingsElement","Settings","Content","isSidebarOpened","openSidebar","toggleSettings","MainContainer","setIsSettingsOpened","setIsSidebarOpened","closeSidebar","navigator","maxTouchPoints","msMaxTouchPoints","mQ","matchMedia","media","matches","test","userAgent","isMobile","App","isLocalhost","Boolean","location","hostname","match","registerValidSW","swUrl","config","serviceWorker","register","then","registration","onupdatefound","installingWorker","installing","onstatechange","controller","log","onUpdate","onSuccess","catch","ReactDOM","render","StrictMode","URL","process","href","origin","contentType","indexOf","ready","unregister","checkValidServiceWorker","serviceWorkerRegistration"],"mappings":"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","file":"static/js/main.55e06d7d.chunk.js","sourcesContent":["import { generateId } from '../utils/commonUtils';\r\n\r\nexport enum Priorities {\r\n    Trivial,\r\n    Minor,\r\n    Normal,\r\n    Major,\r\n    Critical\r\n}\r\n\r\nexport default class Task {\r\n    text: string\r\n    isDone: boolean\r\n    priority: Priorities\r\n    id: string\r\n    updatedAt: number\r\n    parentId: string | null\r\n    subTasks?: Task[]\r\n\r\n    constructor(props: any = {}) {\r\n        const {\r\n            id = generateId(), \r\n            text = '', \r\n            isDone = false, \r\n            priority = Priorities.Trivial, \r\n            updatedAt = Date.now(),\r\n            parentId = null\r\n        } = props\r\n\r\n        this.id = id\r\n        this.text = text\r\n        this.isDone = isDone\r\n        this.priority = priority\r\n        this.updatedAt = updatedAt\r\n        this.parentId = parentId\r\n    }\r\n}\r\n","import './Fog.scss'\r\n\r\ntype Props = {\r\n    isDisplayed: Boolean\r\n}\r\n\r\nconst Fog = (props: Props) => {\r\n    const { isDisplayed = false } = props\r\n\r\n    return <div className=\"fog\" style={{display: isDisplayed ? 'block' : 'none'}}/>\r\n}\r\n\r\nexport default Fog","import './Spinner.scss'\r\n\r\ntype Props = {\r\n    customClass?: string\r\n}\r\n\r\nconst Spinner = (props: Props) =>\r\n    <div className={`spinner ${props.customClass || ''}`} />\r\n\r\nexport default Spinner","import { SyncTargets } from '../classes/Syncer';\r\n\r\nconst METADATA_KEY = 'metadata'\r\nconst SELECTED_PROJECT_ID_KEY = 'selectedProjectId'\r\nconst SETTINGS_KEY = 'settings'\r\nconst TOKENS_KEY = 'tokens'\r\n\r\nexport const hasItem = (key: string): boolean => {\r\n    return !!localStorage.getItem(key)\r\n}\r\n\r\nexport const getObject = (key: string): any => {\r\n    return JSON.parse(localStorage.getItem(key) || '{}')\r\n}\r\n\r\nexport const setObject = (key: string, obj: any): void => {\r\n    localStorage.setItem(key, JSON.stringify(obj))\r\n}\r\n\r\nexport const removeItem = (key: string) => {\r\n    localStorage.removeItem(key)\r\n}\r\n\r\nexport const setSelectedProjectId = (id: string): void => {\r\n    localStorage.setItem(SELECTED_PROJECT_ID_KEY, id)\r\n}\r\n\r\nexport const getSelectedProjectId = (): string => {\r\n    return localStorage.getItem(SELECTED_PROJECT_ID_KEY) || ''\r\n}\r\n\r\nconst getSettings = (): any => { \r\n    return getObject(SETTINGS_KEY)   \r\n}\r\n\r\nexport const getSyncTarget = (): SyncTargets => {\r\n    return getSettings().syncTarget as SyncTargets\r\n}\r\n\r\nexport const setSyncTarget = (syncTarget: SyncTargets): void => {\r\n    setObject(SETTINGS_KEY, { ...getSettings(), syncTarget })\r\n}\r\n\r\nconst getTokens = (): any => {\r\n    return getObject(TOKENS_KEY)\r\n}\r\n\r\nexport const getDropboxToken = (): string => {\r\n    return getTokens().dropboxAccessToken\r\n}\r\n\r\nexport const setDropboxToken = (dropboxAccessToken: string): void => {\r\n    setObject(TOKENS_KEY, { ...getTokens(), dropboxAccessToken })\r\n}\r\n\r\nexport const getMetadada = (): any => {\r\n    return getObject(METADATA_KEY)\r\n}\r\n\r\nexport const setMetadada = (metadata: any) => {\r\n    setObject(METADATA_KEY, metadata)\r\n}\r\n\r\nexport const hasMetadata = (): boolean => {\r\n    return hasItem(METADATA_KEY)\r\n}\r\n","export const isMobile = () => {\r\n    if (navigator.maxTouchPoints) return navigator.maxTouchPoints > 0\r\n    if (navigator.msMaxTouchPoints) return navigator.msMaxTouchPoints > 0\r\n\r\n    const mQ = window.matchMedia && matchMedia(\"(pointer:coarse)\")\r\n    if (mQ && mQ.media === \"(pointer:coarse)\") return !!mQ.matches\r\n\r\n    if ('orientation' in window) return true\r\n\r\n    return (/\\b(BlackBerry|webOS|iPhone|IEMobile)\\b/i.test(navigator.userAgent) ||\r\n            /\\b(Android|Windows Phone|iPad|iPod)\\b/i.test(navigator.userAgent))\r\n}\r\n\r\nexport const readFile = (blob: Blob): Promise<string> => {\r\n    return new Promise((resolve, reject) => {\r\n        const fr = new FileReader()\r\n        fr.onerror = reject\r\n        fr.onload = () => resolve(fr.result as string)\r\n        fr.readAsText(blob)\r\n    })\r\n}\r\n\r\nexport const generateId = (length: number = 10): string => {\r\n    let id = ''\r\n    while (id.length < length) {\r\n        id += Math.floor(Math.random() * 1E10).toString()\r\n    }\r\n    return id.substring(0, length)\r\n}\r\n","import { SyncStatuses } from '../components/Statuses/SyncStatus';\r\nimport DropboxConnector from './DropboxConnector';\r\nimport { reload, store } from './Store'\r\nimport * as lsUtils from \"../utils/localStorageUtils\"\r\nimport * as taskService from '../utils/taskService'\r\nimport metaLocal, { Metadata } from './Metadata'\r\n\r\nconst SYNC_INTERVAL_IN_MINUTES = 10\r\n\r\nexport interface ICloudConnector {\r\n    syncTarget: SyncTargets\r\n    authorize: () => any\r\n    check: () => any\r\n    downloadItems: (names: string[]) => Promise<any[]>\r\n    uploadItems: (files: string[][]) => Promise<void>\r\n    deleteItems: (names: string[]) => Promise<void>\r\n    downloadMetadata: () => Promise<string>\r\n    uploadMetadata: (metadata: string) => void\r\n}\r\n\r\nexport enum SyncTargets {\r\n    Dropbox = 'DROPBOX',\r\n    Disabled = 'DISABLED'\r\n}\r\n\r\nclass Syncer {\r\n    private cloudConnector: ICloudConnector | null = null\r\n    private isSyncFaild: boolean = false\r\n    private interval: any = null\r\n\r\n    async init(cloudConnector?: ICloudConnector) {\r\n        if (cloudConnector) {\r\n            this.cloudConnector = cloudConnector\r\n            lsUtils.setSyncTarget(cloudConnector.syncTarget)\r\n        } else {\r\n            const syncTarget = lsUtils.getSyncTarget()\r\n            if (syncTarget === SyncTargets.Disabled) {\r\n                this.cloudConnector = null\r\n            } else {\r\n                this.cloudConnector = this.createCloudConnector(syncTarget)\r\n            }\r\n        }\r\n        \r\n        clearInterval(this.interval)\r\n\r\n        const isConfigured = this.cloudConnector ? await this.check() : false        \r\n\r\n        if (isConfigured) {\r\n            await this.sync()\r\n            this.interval = setInterval(this.sync.bind(this), 60000 * SYNC_INTERVAL_IN_MINUTES)\r\n        }\r\n    }\r\n\r\n    async sync() {\r\n        if (store.syncStatus === SyncStatuses.InProgress) return\r\n\r\n        this.isSyncFaild = false\r\n        store.syncStatus = SyncStatuses.InProgress\r\n\r\n        try {\r\n            const metaRemote = await this.fetchRemoteMeta()\r\n            await this.syncChanges(metaLocal, metaRemote)\r\n        } catch (e) {\r\n            console.error(e);\r\n            this.isSyncFaild = true\r\n        }\r\n\r\n        store.syncStatus = this.isSyncFaild\r\n            ? SyncStatuses.Failure\r\n            : SyncStatuses.Idle\r\n    }\r\n\r\n    private async check(): Promise<boolean> {\r\n        try {\r\n            await this.cloudConnector!.check()\r\n        } catch(e) {\r\n            if (e.message.toLowerCase().includes('not_configured')) {\r\n                store.syncStatus = SyncStatuses.NotConfigured\r\n                return false\r\n            } else {\r\n                store.syncStatus = SyncStatuses.Failure\r\n                return true\r\n            }\r\n        }\r\n        return true\r\n    }\r\n\r\n    private createCloudConnector(syncTarget?: SyncTargets) {\r\n        switch (syncTarget) {\r\n            case SyncTargets.Dropbox:\r\n                return new DropboxConnector()\r\n            default:\r\n                return null\r\n        }\r\n    }\r\n\r\n    private async fetchRemoteMeta(): Promise<Metadata> {\r\n        const taskListStr = await this.cloudConnector?.downloadMetadata() || '{}'\r\n        const taskList = JSON.parse(taskListStr)\r\n        return new Metadata(taskList)\r\n    }\r\n\r\n    private uploadRemoteMeta(metadata: Metadata) {\r\n        const taskListStr = JSON.stringify(metadata.taskList)\r\n        this.cloudConnector?.uploadMetadata(taskListStr)\r\n    }\r\n\r\n    private processChanges = (local: Metadata, remote: Metadata) => {\r\n        const localList = local.taskList\r\n        const remoteList = remote.taskList\r\n\r\n        if (!Object.keys(remoteList).length) {\r\n            local.created = Object.keys(localList)\r\n            local.deleted = []\r\n            return\r\n        }\r\n      \r\n        local.created.forEach((it) => { remoteList[it] = localList[it] })\r\n        local.deleted.forEach((it) => { remote.removeFromTaskList(it) })\r\n\r\n        Object.keys(localList).forEach((it) => {\r\n            if (!remoteList.hasOwnProperty(it)) {\r\n                remote.addToDeleted(it)\r\n                return\r\n            }\r\n      \r\n            const remoteUpdatedAt = remoteList[it].u\r\n            const localUpdatedAt =  localList[it].u\r\n            if (remoteUpdatedAt > localUpdatedAt) {\r\n                remote.addToUpdated(it)\r\n            } else if (remoteUpdatedAt < localUpdatedAt) {\r\n                local.addToUpdated(it)\r\n            }\r\n        })\r\n      \r\n        Object.keys(remoteList).forEach((it) => {\r\n            if (!localList.hasOwnProperty(it)) {\r\n                remote.addToCreated(it)\r\n            }\r\n        })\r\n    }\r\n\r\n    private syncChanges = async (local: Metadata, remote: Metadata) => {\r\n        this.processChanges(local, remote)\r\n\r\n        const toDownload = remote.created.concat(remote.updated)\r\n        const toUpload = local.created.concat(local.updated)\r\n        const toDeleteLocal = remote.deleted\r\n        const toDeleteRemote = local.deleted\r\n    \r\n        const needToUpdateRemote = toUpload.length || toDeleteRemote.length\r\n        const needToUpdateLocal = toDownload.length || toDeleteLocal.length\r\n\r\n        const items = await this.cloudConnector?.downloadItems(toDownload)\r\n        items?.forEach((it) => taskService.createTask(it))\r\n \r\n        const filesToUpload = toUpload.map((it) => {\r\n            const fileContent = localStorage.getItem(it) || ''\r\n            return [fileContent, it]\r\n        })\r\n        await this.cloudConnector?.uploadItems(filesToUpload)\r\n\r\n        await this.cloudConnector?.deleteItems(toDeleteRemote)\r\n\r\n        toDeleteLocal.forEach((it) => taskService.deleteTask(it))\r\n    \r\n        local.reset()\r\n        local.save()\r\n\r\n        needToUpdateLocal && reload()\r\n\r\n        needToUpdateRemote && this.uploadRemoteMeta(metaLocal)\r\n      }\r\n}\r\n\r\nconst syncer = new Syncer()\r\n\r\nexport default syncer\r\n","import * as lsUtils from '../utils/localStorageUtils'\r\n\r\nexport const ROOT_ID = '0'\r\n\r\nexport type Item = {\r\n    id: string\r\n    parentId: string | null\r\n    updatedAt: number\r\n}\r\n\r\nexport type TaskList = { [id: string]: { p: string | null, u: number } }\r\n\r\nexport class Metadata {\r\n    taskList: TaskList\r\n    created: string[] = []\r\n    deleted: string[] = []\r\n    updated: string[] = []\r\n\r\n    constructor(taskList: TaskList = {}) {\r\n        this.taskList = taskList\r\n    }\r\n\r\n    addToTaskList(item: Item): void {\r\n        const { id, parentId, updatedAt } = item\r\n        this.taskList[id] = {\r\n            p: parentId,\r\n            u: updatedAt\r\n        }\r\n    }\r\n\r\n    removeFromTaskList(id: string): void {\r\n        delete this.taskList[id]\r\n    }\r\n\r\n    addToCreated(id: string): void {\r\n        this.created.push(id)\r\n    }\r\n\r\n    removeFromCreated(id: string): void {\r\n        if (this.created.includes(id)) {\r\n            this.created = this.created.filter((it) => it !== id)\r\n        }\r\n    }\r\n\r\n    addToDeleted(id: string): void {\r\n        this.deleted.push(id)\r\n    }\r\n\r\n    addToUpdated(id: string): void {\r\n        this.updated.push(id)\r\n    }\r\n\r\n    registerCreated(item: Item): void {\r\n        this.addToTaskList(item)\r\n        this.addToCreated(item.id)\r\n        this.save()\r\n    }\r\n\r\n    registerUpdated(item: Item): void {\r\n        this.addToTaskList(item)\r\n        this.save()\r\n    }\r\n\r\n    registerDeleted(id: string): void {\r\n        this.removeFromTaskList(id)\r\n        this.created.includes(id)\r\n            ? this.removeFromCreated(id)\r\n            : this.addToDeleted(id)\r\n        this.save()\r\n    }\r\n\r\n    getChildrenIds(parentId: string): string[] {\r\n        return this.getAllTaskIds().reduce((acc: string[], curr) => {\r\n            if (this.taskList[curr].p === parentId) acc.push(curr)\r\n            return acc\r\n        }, [])\r\n    }\r\n\r\n    hasChildren(parentId: string): boolean {\r\n        return Object.values(this.taskList).some((it) => it.p === parentId)\r\n    }\r\n\r\n    isProject(taskId: string): boolean {\r\n        const taskMetaRecord = this.taskList[taskId]\r\n        return taskMetaRecord && taskMetaRecord.p === ROOT_ID\r\n    }\r\n\r\n    isRoot(taskId: string): boolean {\r\n        return taskId === ROOT_ID\r\n    }\r\n\r\n    getAllTaskIds(): string[] {\r\n        return Object.keys(this.taskList)\r\n    }\r\n\r\n    save(): void {\r\n        const metadata = {\r\n            taskList: this.taskList,\r\n            created: this.created,\r\n            deleted: this.deleted\r\n        }\r\n        lsUtils.setMetadada(metadata)\r\n    }\r\n\r\n    restore(): void {\r\n        const metadata = lsUtils.getMetadada()\r\n        this.taskList = metadata.taskList\r\n        this.created = metadata.created\r\n        this.deleted = metadata.deleted\r\n    }\r\n\r\n    reset(): void {\r\n        this.created = []\r\n        this.deleted = []\r\n        this.updated = []\r\n        this.save()\r\n    }\r\n\r\n    init(): void {\r\n        lsUtils.hasMetadata()\r\n            ? this.restore() \r\n            : this.save()\r\n    }\r\n}\r\n\r\nconst metadata = new Metadata()\r\n\r\nexport default metadata\r\n","import Task from \"../classes/Task\"\r\nimport * as lsUtils from \"./localStorageUtils\"\r\nimport metadata, { ROOT_ID } from '../classes/Metadata'\r\nimport { store } from '../classes/Store' \r\n\r\nexport const initRoot = () => {\r\n    if (hasRoot()) return\r\n    const root = { \r\n        id: '0', \r\n        text: \"Projects\" \r\n    }\r\n    createTask(new Task(root))\r\n}\r\n\r\nexport const hasRoot = (): boolean => {\r\n    return lsUtils.hasItem(ROOT_ID)\r\n}\r\n\r\nexport const getRoot = () => {\r\n    return getTask(ROOT_ID)\r\n}\r\n\r\nexport const getTask = (taskId: string): Task => {\r\n    return lsUtils.getObject(taskId)\r\n}\r\n\r\nexport const getTaskList = (taskIds: string[]): Task[] => {\r\n    return taskIds.reduce((acc: Task[], curr) => {\r\n        acc.push(getTask(curr))\r\n        return acc\r\n    }, [])\r\n}\r\n\r\nexport const getAllTasks = (): Task[] => {\r\n    return getTaskList(metadata.getAllTaskIds())\r\n}\r\n\r\nexport const getSubTasksList = (parentId: string): Task[] => {\r\n    const childrenIds = metadata.getChildrenIds(parentId)\r\n    return getTaskList(childrenIds)\r\n}\r\n\r\nexport const getProjectsList = (): Task[] => {\r\n    const childrenIds = metadata.getChildrenIds(ROOT_ID)\r\n    return getTaskList(childrenIds)\r\n}\r\n\r\nexport const getTasksTree = () => {\r\n    const addSubTasks = (parent: Task) => {\r\n        parent.subTasks = getSubTasksList(parent.id)\r\n        parent.subTasks.forEach((task) => addSubTasks(task))\r\n    }\r\n    const root = getRoot()\r\n    addSubTasks(root)\r\n    return root\r\n}\r\n\r\nexport const updateTask = (task: Task): void => {\r\n    task.updatedAt = Date.now()\r\n    lsUtils.setObject(task.id, task)\r\n    metadata.registerUpdated(task)\r\n}\r\n\r\nexport const createTask = (task: Task): void => {\r\n    if (!task.updatedAt) task.updatedAt = Date.now()\r\n    lsUtils.setObject(task.id, task)\r\n    metadata.registerCreated(task)\r\n}\r\n\r\nexport const createTasks = (tasks: Task[]): void => {\r\n    tasks.forEach((task) => createTask(task))\r\n}\r\n\r\nexport const deleteTask = (taskId: string): void => {\r\n    if (metadata.isProject(taskId) && store.selectedProjectId === taskId) {\r\n        store.selectedProjectId = ''\r\n        lsUtils.setSelectedProjectId('')\r\n    }\r\n    lsUtils.removeItem(taskId)\r\n    metadata.registerDeleted(taskId)\r\n    metadata.getChildrenIds(taskId).forEach((id) => deleteTask(id))\r\n}\r\n\r\nexport const deleteTasks = (taskIds: string[]): void => {\r\n    taskIds.forEach((id) => deleteTask(id))\r\n}\r\n","import { setDropboxToken, getDropboxToken } from './../utils/localStorageUtils';\r\nimport { Dropbox } from 'dropbox'\r\nimport fetch from 'isomorphic-fetch'\r\nimport { generateId } from '../utils/commonUtils'\r\n\r\nconst AUTH_URL = 'https://www.dropbox.com/oauth2/authorize'\r\nconst TOKEN_URL = 'https://api.dropbox.com/oauth2/token'\r\n\r\nexport default class DropboxClient {\r\n    private clientId: string\r\n    private codeVerifier: string\r\n    private dropbox: Dropbox | null | undefined\r\n\r\n    constructor(clientId: string) {\r\n        this.clientId = clientId\r\n        this.codeVerifier = generateId(43)\r\n        this.initDropbox()\r\n    }\r\n\r\n    async check() {\r\n        this.validateConfiguration()\r\n        await this.dropbox!.checkUser({ query: 'maybedo' })\r\n    }\r\n\r\n    async authorize(authorizationCode: string = '') {\r\n        const body = new URLSearchParams({\r\n            code: authorizationCode,\r\n            grant_type: 'authorization_code',\r\n            client_id: this.clientId,\r\n            code_verifier: this.codeVerifier\r\n        })\r\n    \r\n        const response = await fetch(TOKEN_URL, {\r\n          method: 'POST',\r\n          headers: {\r\n            'Content-Type': 'application/x-www-form-urlencoded',\r\n          },\r\n          body\r\n        })\r\n    \r\n        const resData = await response.json()\r\n\r\n        if (!response.ok) {\r\n            throw new Error(resData.error_description)\r\n        }\r\n    \r\n        const accessToken = resData.access_token\r\n\r\n        setDropboxToken(accessToken)\r\n\r\n        this.initDropbox(accessToken)\r\n    }\r\n\r\n    async listFolder(path?: string) {\r\n        path = path || ''\r\n        this.validateConfiguration()\r\n        return await this.dropbox!.filesListFolder({ path })\r\n    }\r\n\r\n    async downloadFile(path: string) {\r\n        this.validateConfiguration()\r\n        return await this.dropbox!.filesDownload({ path })\r\n    } \r\n    \r\n    async uploadFile(contents: Object, path: string) {\r\n        this.validateConfiguration()\r\n        return await this.dropbox!.filesUpload({ contents, path, mode: {'.tag': 'overwrite'} })\r\n    }\r\n\r\n    async deleteFile(path: string) {\r\n        this.validateConfiguration()\r\n        return await this.dropbox!.filesDeleteV2({ path })\r\n    }\r\n\r\n    get authUrl(): string {\r\n        return `${AUTH_URL}?client_id=${this.clientId}&response_type=code&code_challenge_method=plain&code_challenge=${this.codeVerifier}`\r\n    }\r\n\r\n    get isConfigured(): boolean {\r\n        return !!this.dropbox\r\n    }\r\n\r\n    private initDropbox(token?: string) {\r\n        const accessToken = token || getDropboxToken()\r\n        this.dropbox = accessToken \r\n            ? new Dropbox({ accessToken, fetch })\r\n            : null\r\n    }\r\n\r\n    validateConfiguration() {\r\n        if (!this.dropbox) throw new Error('not_configured')\r\n    }\r\n}\r\n","import { readFile } from '../utils/commonUtils';\r\nimport { ICloudConnector, SyncTargets } from './Syncer';\r\nimport DropboxClient from './DropboxClient'\r\n\r\nconst CLIENT_ID = 'lxn28fv9hhsn7id'\r\n\r\nconst DATA_FOLDER_PATH = '/data'\r\nconst METADATA_FILE_PATH = '/metadata.json'\r\n\r\nexport default class DropboxConnector implements ICloudConnector {\r\n    private dropboxClient: DropboxClient\r\n\r\n    syncTarget = SyncTargets.Dropbox\r\n\r\n    constructor() {\r\n        this.dropboxClient = new DropboxClient(CLIENT_ID)\r\n    }\r\n\r\n    get authUrl(): string {\r\n        return this.dropboxClient.authUrl\r\n    }\r\n\r\n    get isConfigured(): boolean {\r\n        return this.dropboxClient.isConfigured\r\n    }\r\n\r\n    async authorize(authorizationCode?: string)  {\r\n        await this.dropboxClient.authorize(authorizationCode)\r\n    }\r\n\r\n    async check() {\r\n        await this.dropboxClient.check()\r\n    }\r\n\r\n    async downloadItems(names: string[]): Promise<any[]> {\r\n        const files = []\r\n        for (const name of names) {\r\n            const path = `${DATA_FOLDER_PATH}/${name}.json`\r\n            const response: any = await this.dropboxClient.downloadFile(path)\r\n            const fileContent = await readFile(response.result.fileBlob)\r\n            files.push(JSON.parse(fileContent as string))\r\n        }\r\n        return files\r\n    }\r\n\r\n    async uploadItems(files: string[][]): Promise<void> {\r\n        for (const file of files) {\r\n            const path = `${DATA_FOLDER_PATH}/${file[1]}.json`\r\n            await this.dropboxClient.uploadFile(file[0], path)\r\n        }\r\n    }\r\n\r\n    async deleteItems(names: string[]): Promise<void> {\r\n        for (const name of names) {\r\n            const path = `${DATA_FOLDER_PATH}/${name}.json`            \r\n            await this.dropboxClient.deleteFile(path)\r\n        }\r\n    }\r\n\r\n    async downloadMetadata(): Promise<string> {        \r\n        try {\r\n            const response: any = await this.dropboxClient.downloadFile(METADATA_FILE_PATH)\r\n            return await readFile(response.result.fileBlob)\r\n        } catch(e) {\r\n            return ''\r\n        }\r\n    }\r\n\r\n    async uploadMetadata(metadata: string) {\r\n        await this.dropboxClient.uploadFile(metadata, METADATA_FILE_PATH)\r\n    }\r\n}\r\n","import syncer from '../../classes/Syncer'\r\nimport './SyncStatus.scss'\r\nimport { \r\n    MdSyncProblem,\r\n    MdSyncDisabled,\r\n    MdSync\r\n} from 'react-icons/md'\r\nimport { usePropertyWithState } from '../../classes/Store'\r\n\r\nexport enum SyncStatuses {\r\n    NotConfigured = 'NOT_CONFIGURED',\r\n    Idle = 'IDLE',\r\n    InProgress = 'IN_PROGRESS',\r\n    Failure = 'FAILURE'\r\n}\r\n\r\nconst SyncStatus = () => {\r\n    const [ status ] = usePropertyWithState('syncStatus')\r\n\r\n    const refresh = () => syncer.sync()\r\n\r\n    const baseClass = 'material-icons-outlined common-btn'\r\n    const noHoverClass = baseClass + ' no-hover'\r\n    const inProgresClass = noHoverClass + ' syncing'\r\n    const failureClass = baseClass + ' failure'\r\n\r\n    const getStatusElement = (status?: SyncStatuses) => {\r\n        switch (status) {\r\n            case SyncStatuses.NotConfigured:\r\n                return <MdSyncDisabled \r\n                            className={noHoverClass}\r\n                            title=\"cloud sync disabled\"\r\n                        />  \r\n            case SyncStatuses.Idle:\r\n                return <MdSync \r\n                            className={baseClass}\r\n                            onClick={refresh}\r\n                            title=\"synchronize\"\r\n                        />     \r\n            case SyncStatuses.InProgress:\r\n                return <MdSync \r\n                            className={inProgresClass}\r\n                            onClick={refresh}\r\n                            title=\"synchronizing\"\r\n                        />                \r\n            case SyncStatuses.Failure:\r\n                return <MdSyncProblem \r\n                            className={failureClass}\r\n                            onClick={refresh}\r\n                            title=\"sync failed\"\r\n                        />            \r\n            default:\r\n                 return <MdSyncDisabled \r\n                            className={noHoverClass}\r\n                            title=\"cloud sync disabled\"\r\n                        />   \r\n        }\r\n    } \r\n\r\n    return (\r\n        <div className='sync-status'>\r\n            {getStatusElement(status)}\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default SyncStatus\r\n","import { createStore } from './StoreFactory';\r\nimport * as lsUtils from \"../utils/localStorageUtils\"\r\nimport { getProjectsList, initRoot } from '../utils/taskService'\r\nimport metadata from './Metadata'\r\nimport { SyncStatuses } from '../components/Statuses/SyncStatus'\r\nimport { IBanner } from '../components/Banner/Banner'\r\n\r\nmetadata.init()\r\ninitRoot()\r\n\r\ntype Store = {\r\n    selectedProjectId: string,\r\n    showLoading: boolean,\r\n    banner: IBanner | null,\r\n    syncStatus: SyncStatuses\r\n}\r\n\r\nexport const initSelectProjectId = () => (\r\n    lsUtils.getSelectedProjectId()\r\n        || getProjectsList()[0]?.id \r\n        || ''\r\n)\r\n\r\nconst initialValue: Store = {\r\n    selectedProjectId: initSelectProjectId(),\r\n    showLoading: false,\r\n    banner: null,\r\n    syncStatus: SyncStatuses.NotConfigured\r\n}\r\n\r\nexport const {\r\n    store,\r\n    notify,\r\n    useEvent,\r\n    usePropertyWithState,\r\n    useReload,\r\n    reload\r\n} = createStore(initialValue)\r\n","import { useEffect } from 'react'\r\nimport './Banner.scss'\r\nimport { MdClose } from 'react-icons/md'\r\nimport { usePropertyWithState } from '../../classes/Store'\r\n\r\nconst Banner = () => {\r\n    const [ banner, setBanner ] = usePropertyWithState('banner')\r\n\r\n    useEffect(() => {\r\n        if (banner && banner.delay && banner.delay > 0) {\r\n            setTimeout(() => setBanner(null), banner.delay * 1000)\r\n        }\r\n    }, [banner, setBanner])\r\n\r\n    if (!banner) return null\r\n\r\n    const { text, type } = banner\r\n\r\n    return (\r\n        <div className={`banner banner-${type}`}>\r\n            <div>{text}</div>\r\n            <MdClose onClick={() => setBanner(null)} />\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Banner\r\n\r\nexport interface IBanner {\r\n    text: string\r\n    type: BannerTypes\r\n    delay?: number\r\n}\r\n\r\nexport enum BannerTypes {\r\n    Success = \"success\",\r\n    Warning = \"warning\",\r\n    Failure = \"failure\"\r\n}\r\n\r\nexport class FailureBanner implements IBanner {\r\n    text: string\r\n    type: BannerTypes\r\n\r\n    constructor(text: string) {\r\n        this.text = text\r\n        this.type = BannerTypes.Failure\r\n    }\r\n}\r\n\r\nexport class SuccessBanner implements IBanner {\r\n    text: string\r\n    type: BannerTypes\r\n    delay: number\r\n\r\n    constructor(text: string, delay: number = 5) {\r\n        this.text = text\r\n        this.type = BannerTypes.Success\r\n        this.delay = delay\r\n    }\r\n}\r\n","import { useEffect, useState } from 'react'\r\n\r\nexport const createStore = <T extends object>(initialValue: T) => {\r\n    type Callback = (value?: any) => void\r\n    type Property = keyof typeof initialValue\r\n    type StoreData = typeof initialValue\r\n\r\n    const subsciptions: Map<Property | string, Callback[]> = new Map()\r\n    \r\n    const subscribe = (property: string, callback: Callback) => {\r\n        const callbacks = subsciptions.get(property)\r\n        callbacks\r\n            ? callbacks.push(callback)\r\n            : subsciptions.set(property, [callback])\r\n    }\r\n\r\n    const unsubscribe = (property: string, callback: Callback) => {\r\n        const callbacks = subsciptions.get(property)\r\n        if (callbacks) {\r\n            const newCallbacks = callbacks.filter((it) => it !== callback)\r\n            subsciptions.set(property as string, newCallbacks)\r\n        }\r\n    }\r\n\r\n    const notify = (property: Property | string, value?: any) => {\r\n        subsciptions.get(property)?.forEach((callback) => callback(value))\r\n    }\r\n\r\n    const toProxy = (obj: StoreData):  StoreData => {\r\n        const proxyHandler = {\r\n            set: (target: any, property: string, value: any) => {\r\n                target[property] = value\r\n                notify(property, value)\r\n                return true\r\n            },\r\n            get: (target: any, property: string) => {\r\n                return target[property]\r\n            }\r\n        }\r\n        return new Proxy(obj, proxyHandler)\r\n    }\r\n\r\n    const store: StoreData = toProxy(initialValue)\r\n\r\n    const useSubscribe = (eventOrProperty: Property | string, callback: Callback) => {  \r\n        useEffect(() => {\r\n            subscribe(eventOrProperty as string, callback)\r\n            return () => unsubscribe(eventOrProperty as string, callback)\r\n        }, [callback, eventOrProperty])\r\n    }\r\n\r\n    const useEvent = (eventName: string, callback: Callback): Callback => {  \r\n        useSubscribe(eventName, callback)\r\n        return (value: any) => notify(eventName, value)\r\n    }\r\n\r\n    const useEventWithState = (eventName: string, callback?: Callback): [any, Callback] => {  \r\n        const [ state, setState ] = useState()\r\n    \r\n        const onNotify = (value: any) => {\r\n            callback && callback(value)\r\n            setState(value)\r\n        }\r\n        useEvent(eventName, onNotify)\r\n    \r\n        return [ state, (value: any) => notify(eventName, value) ]\r\n    }\r\n\r\n    const useProperty = (property: Property, callback: Callback) => { \r\n        useSubscribe(property, callback)\r\n    \r\n        return (value: any) => store[property] = value\r\n    }\r\n    \r\n    const usePropertyWithState = (property: Property, callback?: Callback): [any, Callback] => {  \r\n        const [ state, setState ] = useState(store[property])\r\n    \r\n        const onNotify = (value: any) => {\r\n            callback && callback(value)\r\n            setState(value)\r\n        }\r\n        useProperty(property, onNotify)\r\n    \r\n        return [ state, (value: any) => store[property] = value ]\r\n    }\r\n\r\n    const useReload = (callback: Callback) => {\r\n        const [ , setState ] = useState({})\r\n\r\n        const onNotify = () => {\r\n            callback && callback()\r\n            setState({})\r\n        }\r\n        \r\n        useEvent('reload', onNotify)\r\n    }\r\n\r\n    const reload = () => notify('reload')\r\n\r\n    return {\r\n        store,\r\n        notify,\r\n        useSubscribe,\r\n        useEvent,\r\n        useEventWithState,\r\n        useProperty,\r\n        usePropertyWithState,\r\n        useReload,\r\n        reload\r\n    }\r\n}\r\n","import Fog from '../Fog/Fog'\r\nimport Spinner from './Spinner'\r\nimport './Loading.scss'\r\nimport { usePropertyWithState } from '../../classes/Store'\r\n\r\ntype Props = {\r\n    spinnerClass?: string\r\n}\r\n\r\nconst Loading = (props: Props) => {\r\n    const { spinnerClass } = props\r\n\r\n    const [ showLoading ] = usePropertyWithState('showLoading')\r\n\r\n    if (!showLoading) return null\r\n    \r\n    return (\r\n        <>\r\n            <Fog isDisplayed={true} />\r\n            <div className=\"loading\">\r\n                <Spinner customClass={spinnerClass} />\r\n            </div>\r\n        </>\r\n    )\r\n}\r\n\r\nexport default Loading\r\n","import { \r\n    MutableRefObject, \r\n    useEffect \r\n} from \"react\"\r\n\r\nexport const useOutsideClickDetector = (\r\n    ref: MutableRefObject<HTMLElement | null>, \r\n    action: Function, \r\n    isEnabled: boolean = true) => \r\n{\r\n    useEffect(() => {\r\n        if (!isEnabled) return\r\n\r\n        const handleClickOutside = (e: any) => {\r\n            if (ref.current && !ref.current.contains(e.target)) {\r\n                action()\r\n            }\r\n        }\r\n\r\n        document.addEventListener(\"mousedown\", handleClickOutside)\r\n\r\n        return () => document.removeEventListener(\"mousedown\", handleClickOutside)\r\n    }, [action, isEnabled, ref])\r\n}\r\n","import { memo } from 'react'\r\nimport './Record.scss'\r\nimport Task from '../../classes/Task'\r\nimport { MdAdd } from 'react-icons/md'\r\n\r\ntype Props = { add: (task: Task) => void }\r\n \r\nconst AddRecord = ({ add }: Props) => {    \r\n    const createRecord = (e: any) => {\r\n        const text = e.target.textContent.trim()\r\n        if (!text) return\r\n        const task = new Task({ text })\r\n        add(task)\r\n        e.target.textContent = ''\r\n    }\r\n\r\n    return (  \r\n        <div className=\"record add-record\">\r\n            <div className=\"row-btns\">\r\n                <MdAdd />\r\n            </div>\r\n            <div \r\n                className=\"item-content\" \r\n                contentEditable=\"true\"\r\n                suppressContentEditableWarning={true}\r\n                onInput={createRecord}\r\n                onKeyPress={preventEnterOnEmpty}\r\n            ></div>\r\n        </div>\r\n    )\r\n}\r\n\r\nconst preventEnterOnEmpty = (e: any) => {\r\n    !e.target.textContent.trim() && e.key === 'Enter' && e.preventDefault()\r\n}\r\n\r\nexport default memo(AddRecord)\r\n","import './Button.scss'\r\nimport { MdCheckBoxOutlineBlank, MdCheckBox } from 'react-icons/md'\r\n\r\ntype Props = {\r\n    actionOnClick: (e: any) => void\r\n    isChecked?: boolean,\r\n    priority: number\r\n}\r\n\r\nconst CheckmarkButton = (props: Props) => {\r\n    const {\r\n        actionOnClick,\r\n        isChecked = false,\r\n        priority\r\n    } = props\r\n\r\n    const classes = [ \r\n        'common-btn', \r\n        'checkmark-btn', \r\n        isChecked ? 'prio-0' : 'prio-' + priority \r\n    ].join(' ')\r\n\r\n    return (\r\n        <>\r\n            {isChecked\r\n                ? <MdCheckBox \r\n                    className={classes} \r\n                    onClick={actionOnClick}\r\n                />\r\n                : <MdCheckBoxOutlineBlank \r\n                    className={classes} \r\n                    onClick={actionOnClick}\r\n                />\r\n            }\r\n        </>\r\n    )\r\n}\r\n\r\nexport default CheckmarkButton\r\n","import { useState, useRef } from \"react\"\r\nimport { RiDeleteBin7Fill, RiDeleteBinFill } from 'react-icons/ri'\r\nimport { MdCheck, MdClose } from \"react-icons/md\"\r\nimport { useOutsideClickDetector } from '../../utils/customHooks'\r\nimport Task from \"../../classes/Task\"\r\nimport { notify } from \"../../classes/Store\"\r\n\r\ntype Props = {\r\n    task: Task,\r\n    isBulk?: boolean,\r\n    isDisabled?: boolean,\r\n    closeMenu?: () => void\r\n    remove: (task: Task) => void\r\n}\r\n\r\nconst DeleteRecords = (props: Props) => {\r\n    const { \r\n        task, \r\n        isBulk = false, \r\n        isDisabled = false,\r\n        closeMenu = () => {},\r\n        remove\r\n     } = props\r\n\r\n    const [ showDeleteConfirmation, setShowDeleteConfirmation ] = useState(false)\r\n\r\n    const deleteRecord = (e: any) => {\r\n        e.stopPropagation()\r\n        setShowDeleteConfirmation(false)\r\n        remove(task)\r\n    }\r\n\r\n    const deleteCompleted = (e: any) => {\r\n        e.stopPropagation()\r\n        setShowDeleteConfirmation(false)\r\n        notify('deleteCompleted' + task.id)\r\n        closeMenu()\r\n    }\r\n\r\n    const openDeleteConfirmation = (e: any) => {\r\n        e && e.stopPropagation()\r\n        setShowDeleteConfirmation(true)\r\n    }\r\n\r\n    const closeDeleteConfirmation = (e: any) => {\r\n        e && e.stopPropagation()\r\n        setShowDeleteConfirmation(false)\r\n    }\r\n\r\n    const confirmRef = useRef(null)\r\n    useOutsideClickDetector(confirmRef, closeDeleteConfirmation, showDeleteConfirmation)\r\n\r\n    const configSingle = {\r\n        icon: <RiDeleteBin7Fill />,\r\n        text: 'Delete',\r\n        tooltip: 'Delete task',\r\n        deleteAction: deleteRecord\r\n    }\r\n    \r\n    const configBulk = {\r\n        icon: <RiDeleteBinFill />,\r\n        text: 'Clear',\r\n        tooltip: 'Delete completed subtasks',\r\n        deleteAction: deleteCompleted\r\n    }\r\n\r\n    const { \r\n        icon, \r\n        text, \r\n        tooltip, \r\n        deleteAction \r\n    } = isBulk ? configBulk : configSingle\r\n\r\n    const classNames = [ 'record-menu-row' ]\r\n    isDisabled && classNames.push('disabled')\r\n\r\n    return (\r\n        <>\r\n            {showDeleteConfirmation \r\n                ?\r\n                <div className=\"record-menu-row\" ref={confirmRef}>\r\n                    <div className=\"inline-menu-btn\">\r\n                        <MdCheck onClick={deleteAction} />\r\n                    </div>\r\n                    <div className=\"inline-menu-btn\">\r\n                        <MdClose onClick={closeDeleteConfirmation} />\r\n                    </div>\r\n                </div>\r\n                :\r\n                <div \r\n                    onClick={openDeleteConfirmation} \r\n                    title={tooltip} \r\n                    className={classNames.join(' ')}\r\n                >\r\n                    {icon}\r\n                    <div className=\"menu-item-text\">{text}</div>\r\n                </div>\r\n            }\r\n        </>\r\n    )\r\n}\r\n\r\nexport default DeleteRecords\r\n","import { useState, useRef } from 'react'\r\nimport Task, { Priorities } from '../../classes/Task'\r\nimport { RiFilePptFill } from 'react-icons/ri'\r\nimport { useOutsideClickDetector } from '../../utils/customHooks'\r\n\r\nconst PRIORITY_NAMES = new Map([\r\n    [Priorities.Trivial, 'Trivial'],\r\n    [Priorities.Minor, 'Minor'],\r\n    [Priorities.Normal, 'Normal'],\r\n    [Priorities.Major, 'Major'],\r\n    [Priorities.Critical, 'Critical'],\r\n    [undefined, 'Trivial'],\r\n])\r\n\r\ntype Props = { \r\n    task: Task,\r\n    closeMenu: () => void,\r\n    update: (task: Task) => void\r\n}\r\n\r\nconst Priority = (props: Props) => {\r\n    const {\r\n        task,\r\n        closeMenu,\r\n        update\r\n    } = props\r\n\r\n    const [ showSelector, setShowSelector ] = useState(false)\r\n\r\n    const openSelector = (e: any) => {\r\n        e.stopPropagation()\r\n        setShowSelector(true)\r\n    }\r\n    const closeSelector = () => setShowSelector(false)\r\n\r\n    const switchRef = useRef(null)\r\n    useOutsideClickDetector(switchRef, closeSelector, showSelector)\r\n\r\n    const handleClickOnSwitch = (e: any) => {\r\n        e.stopPropagation()\r\n\r\n        const el = e.target as HTMLDivElement   \r\n        const newPrio = parseInt(el.textContent!)     \r\n        if (newPrio !== task.priority) {\r\n            task.priority = newPrio\r\n            update(task)\r\n        }\r\n        closeMenu() \r\n    }\r\n\r\n    return (\r\n        <>\r\n            {showSelector \r\n                ? <div \r\n                    className=\"record-menu-row priority-switch\" \r\n                    onClick={handleClickOnSwitch}\r\n                    ref={switchRef} \r\n                >\r\n                    <div className=\"inline-menu-btn\"><div>{Priorities.Trivial}</div></div>\r\n                    <div className=\"inline-menu-btn\"><div>{Priorities.Minor}</div></div>\r\n                    <div className=\"inline-menu-btn\"><div>{Priorities.Normal}</div></div>\r\n                    <div className=\"inline-menu-btn\"><div>{Priorities.Major}</div></div>\r\n                    <div className=\"inline-menu-btn\"><div>{Priorities.Critical}</div></div>\r\n                </div> \r\n                : <div \r\n                    className=\"record-menu-row\" \r\n                    onClick={openSelector} \r\n                    title=\"Set task priotity\"\r\n                >\r\n                    <RiFilePptFill className=\"menu-item-icon\" />\r\n                    <div className=\"menu-item-text\">\r\n                        {PRIORITY_NAMES.get(task.priority)}\r\n                    </div>\r\n                </div>\r\n            }\r\n        </>\r\n    )\r\n}\r\n\r\nexport default Priority\r\n","import { RiFileAddFill } from 'react-icons/ri'\r\n\r\ntype Props = {\r\n    closeMenu: () => void\r\n    showSubtasks: () => void\r\n    isDisabled?: boolean\r\n}\r\n\r\nconst AddSubtask = ({ closeMenu, showSubtasks, isDisabled = false }: Props) => {\r\n    const handleClickOnAddSubtask = () => {\r\n        closeMenu()\r\n        showSubtasks()\r\n    }\r\n\r\n    const classes = [\r\n        'record-menu-row',\r\n        isDisabled ? 'disabled' : ''\r\n    ].join(' ')\r\n\r\n    return (\r\n        <div \r\n            className={classes}\r\n            title=\"Add subtask\" \r\n            onClick={handleClickOnAddSubtask}\r\n        >\r\n            <RiFileAddFill className=\"menu-item-icon\" />\r\n            <div className=\"menu-item-text\">Add</div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default AddSubtask\r\n","import { useRef, useState } from 'react'\r\nimport { MdMoreVert } from \"react-icons/md\"\r\nimport Task from '../../classes/Task'\r\nimport { useOutsideClickDetector } from '../../utils/customHooks'\r\nimport DeleteRecords from './DeleteRecords'\r\nimport Priority from './Priority'\r\nimport './RecordMenu.scss'\r\nimport AddSubtask from './AddSubtask'\r\n\r\ntype Props = {\r\n    task: Task,\r\n    classes?: string[],\r\n    showSubtasks: () => void,\r\n    update: (task: Task) => void,\r\n    remove: (task: Task) => void,\r\n    isProject: boolean,\r\n    isRoot: boolean\r\n}\r\n\r\nconst RecordMenu = (props: Props) => {\r\n    const {\r\n        task,\r\n        classes = [],\r\n        showSubtasks,\r\n        update,\r\n        remove,\r\n        isProject,\r\n        isRoot\r\n    } = props\r\n\r\n    const [ showMenu, setShowMenu ] = useState(false)\r\n\r\n    const openMenu = (e: any) => {\r\n        e.stopPropagation() // prevent task selection on click\r\n        setShowMenu(true)\r\n    }\r\n\r\n    const closeMenu = () => setShowMenu(false)\r\n\r\n    const menuRef = useRef(null)\r\n    useOutsideClickDetector(menuRef, closeMenu, showMenu)\r\n\r\n    let closeTimeout: any\r\n    const handleMouseLeave = () => {\r\n        closeTimeout = setTimeout(closeMenu, 500)\r\n    }\r\n    const handleMouseEnter = () => {\r\n        clearTimeout(closeTimeout)\r\n    }\r\n    \r\n    return (\r\n        <div className={'record-menu-box ' + classes.join(' ')}>\r\n            <MdMoreVert className=\"common-btn\" onClick={openMenu} />\r\n            {showMenu && <div \r\n                className=\"record-menu\"\r\n                ref={menuRef} \r\n                onMouseLeave={handleMouseLeave}\r\n                onMouseEnter={handleMouseEnter}\r\n            >\r\n                {!task.isDone && !isRoot && <Priority \r\n                    task={task} \r\n                    closeMenu={closeMenu} \r\n                    update={update}\r\n                />}\r\n                {!isProject && !task.isDone && !isRoot && <AddSubtask \r\n                    closeMenu={closeMenu}\r\n                    showSubtasks={showSubtasks}\r\n                    isDisabled={false}\r\n                />}\r\n                <DeleteRecords\r\n                    task={task} \r\n                    isBulk\r\n                    isDisabled={false}\r\n                    closeMenu={closeMenu}\r\n                    remove={remove}\r\n                />\r\n                {!isRoot && \r\n                    <DeleteRecords \r\n                        task={task}\r\n                        remove={remove}\r\n                    />\r\n                }\r\n            </div>}\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default RecordMenu\r\n","import { useRef, useEffect } from 'react'\r\n\r\ntype Props = { \r\n    text: string, \r\n    isEditable: boolean,\r\n    update: (text: string) => void,\r\n    getFocus?: boolean\r\n}\r\n\r\nconst Editable = (props: Props) => {\r\n    const {\r\n        text,\r\n        isEditable,\r\n        update,\r\n        getFocus = false\r\n    } = props\r\n\r\n    const editableRef = useRef<HTMLDivElement>(null)\r\n\r\n    const caretPosRef = useRef<number | undefined>(undefined)\r\n\r\n    useEffect(() => {\r\n        if (getFocus) {            \r\n            setContentEditable(true)\r\n            setCaretPosition(editableRef.current, text.length)\r\n            editableRef.current?.focus()\r\n        }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, [])\r\n\r\n    useEffect(() => {\r\n        if (document.activeElement === editableRef.current) {\r\n            setCaretPosition(editableRef.current, caretPosRef.current)\r\n        }\r\n    })\r\n        \r\n    const setContentEditable = (flag: boolean) => {\r\n        const el = editableRef.current\r\n        el?.setAttribute('contenteditable', '' + flag)\r\n    }\r\n\r\n    const handleInput = debounceInput((text: string) => {    \r\n        // +1 fixes position for multiline\r\n        caretPosRef.current = getCaretPosition(editableRef.current) + 1  \r\n        // do not rerender on enter\r\n        if (!text.endsWith('\\n')) update(text)\r\n    })\r\n\r\n    const handleBlur = () => {\r\n        !isEditable && setContentEditable(false)\r\n    }\r\n\r\n    return (\r\n        <div \r\n            ref={editableRef}\r\n            className=\"item-content\"\r\n            contentEditable={isEditable}\r\n            suppressContentEditableWarning={true}\r\n            onInput={handleInput}\r\n            onBlur={handleBlur}\r\n        >\r\n            {text}\r\n        </div>\r\n    )\r\n}\r\n\r\nconst debounceInput = (callback: (text: string) => void) => {\r\n    let timeout: any\r\n    return (e: any) => {\r\n        const text = e.target.innerText\r\n        clearTimeout(timeout)\r\n        timeout = setTimeout(() => callback(text), 700)\r\n    }\r\n}\r\n\r\nconst getCaretPosition = (el: HTMLElement | null): number => {\r\n    if (!el || !el.isContentEditable) return 0\r\n    let range\r\n    try {\r\n        range = document.getSelection()?.getRangeAt(0)\r\n    } catch(err) {\r\n        // do nothing\r\n    }\r\n    if (!range) return 0\r\n    let rangeClone = range.cloneRange()\r\n    rangeClone.selectNodeContents(el)\r\n    rangeClone.setEnd(range.endContainer, range.endOffset)\r\n    return rangeClone.toString().length || 0\r\n}\r\n\r\nconst setCaretPosition = (el: HTMLElement | null, pos?: number): void => {\r\n    if (!el) return\r\n    const range = document.createRange()\r\n    const selection = window.getSelection()\r\n    const elContentNode = el.childNodes[0]\r\n    if (!elContentNode || !elContentNode.textContent) return\r\n    const textLength = elContentNode.textContent.length\r\n    const positionNormalized = pos !== undefined \r\n        ? Math.min(pos, textLength) \r\n        : textLength\r\n    range.setStart(elContentNode, positionNormalized)\r\n    range.collapse()\r\n    selection?.removeAllRanges()\r\n    selection?.addRange(range)\r\n}\r\n\r\nexport default Editable\r\n","import { useState, memo, useEffect } from 'react'\r\nimport './Record.scss'\r\nimport Task from '../../classes/Task'\r\nimport CheckmarkButton from '../Buttons/CheckmarkButton'\r\nimport { MdExpandLess, MdExpandMore } from 'react-icons/md'\r\nimport RecordMenu from '../RecordMenu/RecordMenu'\r\nimport Editable from './Editable'\r\nimport { updateTask } from '../../utils/taskService'\r\nimport RecordList from '../RecordList/RecordList'\r\nimport { store, useEvent } from '../../classes/Store'\r\nimport metadata from '../../classes/Metadata'\r\n\r\ntype Props = { \r\n    item: Task, \r\n    isEditable?: boolean,\r\n    isTitle?: boolean,\r\n    isSelected?: boolean,\r\n    update?: (task: Task) => void,\r\n    remove?: (task: Task) => void,\r\n    isFocused?: boolean\r\n}\r\n\r\nconst Record = (props: Props) => {\r\n    const {\r\n        isEditable = true,\r\n        isTitle = false,\r\n        isSelected = false,\r\n        isFocused = false,\r\n        item,\r\n        update = () => {},\r\n        remove = () => {},\r\n        item: {\r\n            id, \r\n            isDone,\r\n            priority\r\n        }\r\n    } = props\r\n\r\n    const hasSubtasks = metadata.hasChildren(id)\r\n    const isProject = metadata.isProject(id)\r\n    const isRoot = metadata.isRoot(id)\r\n\r\n    const [ showSubtasks, setShowSubtasks ] = useState(false)\r\n    const [ text, setText ] = useState(item.text)\r\n\r\n    // rerender record after updating from cloud \r\n    useEffect(() => setText(item.text), [item.text])\r\n\r\n    const updateTitle = useEvent('title' + id, setText)\r\n    \r\n    const handleClickOnRecord = () => { \r\n        if (isProject && !isRoot) store.selectedProjectId = id\r\n    }\r\n\r\n    const updateText = (text: string) => {\r\n        text = isTitle \r\n            ? text.replace(/\\n/g, ' ')\r\n            : text\r\n        setText(text)\r\n        item.text = text\r\n        updateTask(item)\r\n        isProject && updateTitle(text)\r\n    }\r\n\r\n    const handleClickOnCheckbox = (e: any) => {\r\n        e.stopPropagation()\r\n        if (e.button === 0) { // left click only\r\n            item.isDone = !item.isDone\r\n            update(item)\r\n        }\r\n    }\r\n\r\n    const recordClassName = [\r\n        'record', \r\n        isSelected ? 'record-selected' : '',\r\n        !isEditable ? 'read-only' : '',\r\n        isTitle ? 'title' : '',\r\n        isProject? 'project' : '',\r\n        isDone ? 'item-done' : ''\r\n    ].join(' ')\r\n        \r\n    const hiddenBtnClassName = window.iAmRunningOnMobile ? '' : 'hidden-btn' \r\n\r\n    const openSubtasks = () => {\r\n        setShowSubtasks(true)\r\n    }\r\n\r\n    const closeSubtasks = () => {\r\n        setShowSubtasks(false)\r\n    }\r\n\r\n    const getSubtasksBtn = () => {\r\n        const classes = \"common-btn subtasks-btn\"\r\n        if (hasSubtasks && !showSubtasks) {\r\n            return <MdExpandMore onClick={openSubtasks} className={classes} />\r\n        }\r\n        if (showSubtasks) {\r\n            return <MdExpandLess onClick={closeSubtasks} className={classes} />\r\n        }\r\n        return null\r\n    }\r\n\r\n    return (\r\n        <>\r\n            <div \r\n                className={recordClassName}\r\n                onClick={handleClickOnRecord}\r\n            >\r\n                <div className=\"row-btns\">\r\n                    <CheckmarkButton \r\n                        actionOnClick={handleClickOnCheckbox} \r\n                        isChecked={isDone}\r\n                        priority={priority}\r\n                    />\r\n                </div>\r\n                <Editable \r\n                    text={text} \r\n                    update={updateText} \r\n                    isEditable={isEditable}\r\n                    getFocus={isFocused}\r\n                />\r\n                {/* DEBUG: display task ID for each record  */}\r\n                {/* <span style={{fontSize: '10px'}}>{id}</span> */}\r\n                <div className=\"row-btns\">\r\n                    {getSubtasksBtn()}\r\n                    {(!isTitle || isRoot) &&\r\n                        <RecordMenu \r\n                            task={item} \r\n                            showSubtasks={openSubtasks}\r\n                            classes={[ hiddenBtnClassName ]}\r\n                            isProject={isProject}\r\n                            isRoot={isRoot}\r\n                            update={update}\r\n                            remove={remove}\r\n                        /> \r\n                    }\r\n\r\n                </div>\r\n            </div>\r\n            {showSubtasks && \r\n                <RecordList \r\n                    classNames={['subtasks-list']}\r\n                    rootId={id}\r\n                />\r\n            }\r\n        </>\r\n    )\r\n}\r\n\r\nexport default memo(Record)\r\n","import { \r\n    useCallback, \r\n    useEffect, \r\n    useRef, \r\n    useState \r\n} from 'react'\r\nimport AddRecord from '../Record/AddRecord'\r\nimport Task, { Priorities } from '../../classes/Task'\r\nimport Record from '../Record/Record'\r\nimport './RecordList.scss'\r\nimport { \r\n    createTask, \r\n    deleteTask, \r\n    deleteTasks, \r\n    getSubTasksList, \r\n    getTask, \r\n    updateTask \r\n} from '../../utils/taskService'\r\nimport { store, useEvent, useReload } from '../../classes/Store'\r\nimport metadata from '../../classes/Metadata'\r\n\r\ntype Props = { \r\n    classNames?: string[],\r\n    rootId: string,\r\n    hasTitle?: boolean,\r\n    isEditable?: boolean,\r\n    projectId?: string\r\n}\r\n\r\nconst RecordList = (props: Props) => {\r\n    const {\r\n        classNames = [],\r\n        rootId,\r\n        hasTitle = false,\r\n        isEditable = true,\r\n        projectId\r\n    } = props\r\n\r\n    const [root, setRoot] = useState<Task>(new Task())\r\n    const [subTasks, setSubTasks] = useState<Task[]>([])\r\n\r\n    const setData = () => {\r\n        const task = getTask(rootId)\r\n        setRoot(task)\r\n        const subTasks = getSubTasksList(rootId)\r\n        setSubTasks(subTasks)\r\n    }\r\n\r\n    useReload(setData)\r\n\r\n    useEffect(setData, [rootId])\r\n\r\n    const focusedItemId = useRef<string>()\r\n\r\n    const isRootList = metadata.isRoot(rootId)\r\n\r\n    const addSubTask = useCallback((task: Task) => {\r\n        task.parentId = root.id\r\n\r\n        createTask(task)\r\n        \r\n        focusedItemId.current = task.id\r\n\r\n        const newSubTasks = subTasks.concat(task)\r\n        setSubTasks(newSubTasks)\r\n\r\n        if (isRootList) store.selectedProjectId = task.id\r\n    }, [isRootList, root.id, subTasks])\r\n\r\n    const updateSubTask = useCallback((task: Task) => {\r\n        const newSubTasks = subTasks.map((it) => {\r\n            return it.id === task.id ? task : it  \r\n        })\r\n        setSubTasks(newSubTasks)\r\n        updateTask(task)\r\n    }, [subTasks])\r\n\r\n    const deleteSubTask = useCallback((task: Task) => {\r\n        const isSelectedPojectDeleted = store.selectedProjectId === task.id\r\n        const newSubTasks = subTasks.filter((it) => it !== task)\r\n        setSubTasks(newSubTasks)\r\n        deleteTask(task.id)\r\n        if (isSelectedPojectDeleted) store.selectedProjectId = ''\r\n    }, [subTasks])\r\n\r\n    const deleteCompletedSubTask = useCallback(() => {\r\n        const idsToDelete = subTasks.filter((it) => it.isDone).map((it) => it.id)\r\n        const isSelectedPojectDeleted = idsToDelete\r\n            .some((id) => store.selectedProjectId === id)\r\n        const newSubTasks = subTasks.filter((it) => !it.isDone)\r\n        setSubTasks(newSubTasks)\r\n        deleteTasks(idsToDelete)\r\n        if (isSelectedPojectDeleted) store.selectedProjectId = ''\r\n    }, [subTasks])\r\n\r\n    useEvent('deleteCompleted' + rootId, deleteCompletedSubTask)\r\n\r\n    // sort subtask by priority\r\n    const setAndComparePriotity = (a: Task, b: Task) => {\r\n        const pa = a.priority || Priorities.Trivial\r\n        const pb = b.priority || Priorities.Trivial\r\n\r\n        if (pa > pb) return -1\r\n        if (pa < pb) return 1\r\n        return 0\r\n    }\r\n    subTasks.sort(setAndComparePriotity)\r\n\r\n    const activeTasks = subTasks.filter((t) => !t.isDone)\r\n    const completedTasks = subTasks.filter((t) => t.isDone)\r\n\r\n    const activeItemListRef = useRef<HTMLDivElement>(null)\r\n\r\n    const classes = [\r\n        isRootList ? 'project-list' : 'task-list',\r\n        ...classNames\r\n    ].join(' ')\r\n\r\n    return (\r\n        <div className={classes}>\r\n            {hasTitle && \r\n                <>\r\n                    <Record \r\n                        key={root.id}\r\n                        item={root} \r\n                        isTitle\r\n                        isEditable={isEditable}\r\n                    />\r\n                </>\r\n            }\r\n            <div className=\"active-tasks\" ref={activeItemListRef}>\r\n                {activeTasks.map(\r\n                    (task: Task) => \r\n                        <Record \r\n                            key={task.id} \r\n                            item={task}\r\n                            isEditable={isEditable}\r\n                            isSelected={projectId === task.id}\r\n                            update={updateSubTask}\r\n                            remove={deleteSubTask}\r\n                            isFocused={focusedItemId.current === task.id}\r\n                        />\r\n                )}\r\n            </div>\r\n            <AddRecord add={addSubTask}/>\r\n            {!!completedTasks.length && <div className=\"completed-tasks\">\r\n                {completedTasks.map(\r\n                    (task: Task) => \r\n                        <Record \r\n                            key={task.id}\r\n                            item={task}\r\n                            isEditable={isEditable}\r\n                            isSelected={projectId === task.id}\r\n                            update={updateSubTask}\r\n                            remove={deleteSubTask}\r\n                        />\r\n                )}\r\n            </div>}\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default RecordList\r\n","import { useRef } from 'react'\r\nimport { useOutsideClickDetector } from '../../utils/customHooks'\r\nimport Fog from '../Fog/Fog'\r\nimport './Sidebar.scss'\r\nimport { BsBoxArrowLeft } from 'react-icons/bs'\r\nimport RecordList from '../RecordList/RecordList'\r\nimport { ROOT_ID } from '../../classes/Metadata'\r\n\r\ntype Props = {\r\n    isOpened: boolean,\r\n    close: () => void,\r\n    isSettingsOpened: boolean,\r\n    projectId: string\r\n}\r\n\r\nconst Sidebar = (props: Props) => {\r\n    const { \r\n        isOpened, \r\n        close, \r\n        isSettingsOpened, \r\n        projectId \r\n    } = props\r\n\r\n    const leftPanelRef = useRef(null)\r\n    useOutsideClickDetector(leftPanelRef, close, isOpened) \r\n\r\n    const handleClick = (e: any) => {\r\n        const el = e.target as HTMLDivElement  \r\n              \r\n        if (el.getAttribute('contenteditable') === \"false\") close()\r\n    }\r\n\r\n    const classes = [\r\n        'left-panel',\r\n        isOpened ? 'panel-opened' : '',\r\n        isSettingsOpened? 'no-scroll' : ''\r\n    ].join(' ')\r\n\r\n    return (\r\n        <div \r\n            ref={leftPanelRef} \r\n            className={classes} \r\n            onClick={handleClick}\r\n        >\r\n            <Fog isDisplayed={isSettingsOpened} />\r\n                <div className=\"top-panel\">\r\n                    <div className=\"row-btns\">\r\n                        <BsBoxArrowLeft \r\n                            onClick={close}\r\n                            className=\"common-btn close-menu-btn\"\r\n                            title=\"hide projects list\"\r\n                        />\r\n                    </div>\r\n                </div>\r\n            <RecordList \r\n                rootId={ROOT_ID}\r\n                hasTitle\r\n                isEditable={false}\r\n                projectId={projectId}\r\n            />\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Sidebar\r\n","import { useRef, useState } from 'react'\r\nimport Task from '../../classes/Task'\r\nimport { FailureBanner, SuccessBanner } from '../Banner/Banner'\r\nimport { readFile } from '../../utils/commonUtils'\r\nimport { reload, store } from '../../classes/Store'\r\nimport Portal from '../../HOCs/Portal'\r\nimport ImportModal from './ImportModal'\r\nimport Button from '../Buttons/Button'\r\nimport { \r\n    createTasks, \r\n    getAllTasks, \r\n    getTasksTree \r\n} from '../../utils/taskService'\r\n\r\nenum DataTypes {\r\n    JSON = 'json',\r\n    HTML = 'html'\r\n}\r\n\r\ntype Props = {\r\n    backToTaskList(): void\r\n}\r\n\r\nconst ExportImport = (props: Props) => {\r\n    const [ showModal, setShowModal ] = useState(false)\r\n\r\n    const { backToTaskList } = props\r\n\r\n    const fileInputRef = useRef<HTMLInputElement>(null)\r\n\r\n    let dataType = DataTypes.JSON\r\n\r\n    const exportData = () => {\r\n        switch (dataType) {\r\n            case DataTypes.JSON:\r\n                exportDataAsJson()\r\n                break\r\n            case DataTypes.HTML:\r\n                exportDataAsHtml()\r\n                break\r\n            default:\r\n                exportDataAsJson()\r\n        }\r\n    }\r\n\r\n    const doImport = async () => {\r\n        let tasks: Task[] | null = null\r\n        try {\r\n            const files = fileInputRef.current?.files\r\n            if (files) {\r\n                const fileContent = await readFile(files[0])\r\n                tasks = JSON.parse(fileContent)\r\n                clearFileInput()\r\n                setShowModal(false)\r\n            }\r\n        } catch(err) {\r\n            setShowModal(false)\r\n            store.banner = new FailureBanner('Failed to parse JSON file')\r\n            clearFileInput()\r\n            return\r\n        }\r\n        if (!tasks) {\r\n            store.banner = new FailureBanner('No exported tasks found')\r\n            return\r\n        }\r\n        \r\n        createTasks(tasks)\r\n        backToTaskList()\r\n        reload()\r\n        \r\n        store.banner = new SuccessBanner('Data successfully imported', 5)\r\n    }\r\n\r\n    const clickOnFileInput = () => {\r\n        const node = fileInputRef.current!\r\n        node.click()\r\n    }\r\n\r\n    const clearFileInput = () => {\r\n        const node = fileInputRef.current!\r\n        node.value = ''\r\n    }\r\n\r\n    const setDataType = (e: any) => {\r\n        dataType = e.target.value\r\n    }\r\n\r\n    const onModalConfirm = () => {\r\n        doImport()\r\n    }\r\n\r\n    const onModalCancel = () => {\r\n        clearFileInput()\r\n        setShowModal(false)\r\n    }\r\n\r\n    return (\r\n        <div className=\"settings-block\">\r\n            <h2>Import/Export your data</h2>\r\n            <Button text='export' action={exportData} />\r\n            <span className=\"words-between\">as</span>\r\n            <select className=\"data-types-select\" onChange={setDataType}>\r\n                <option value={DataTypes.JSON}>{DataTypes.JSON.toUpperCase()}</option>\r\n                <option value={DataTypes.HTML}>{DataTypes.HTML.toUpperCase()}</option>\r\n            </select>\r\n            <Button \r\n                text='import json' \r\n                action={clickOnFileInput} \r\n                classNames={['import-btn']} \r\n            />\r\n            <input \r\n                className=\"input-hidden\" \r\n                type=\"file\" \r\n                accept=\".json\" \r\n                onChange={() => setShowModal(true)} \r\n                ref={fileInputRef} \r\n            />\r\n            {showModal && \r\n            <Portal>\r\n                <ImportModal onCancel={onModalCancel} onConfirm={onModalConfirm} />\r\n            </Portal>}\r\n        </div>\r\n    )\r\n}\r\n\r\nconst doExport = (data: string, type: DataTypes) => {\r\n    const dataToExport = `data:text/${type};charset=utf-8,${data}`\r\n    const encodedUri = encodeURI(dataToExport)\r\n    const link = document.createElement('a')\r\n    link.setAttribute('href', encodedUri)\r\n    link.setAttribute('download', getExportFileName(type));\r\n    link.click();\r\n}\r\n\r\nconst exportDataAsJson = () => {\r\n    doExport(convertDataToJsonString(), DataTypes.JSON)\r\n}\r\n\r\nconst exportDataAsHtml = () => {\r\n    const taskTree = getTasksTree()\r\n    const content = convertDataToHtmlString(taskTree)\r\n    const styles = 'body { font-family: sans-serif; font-size: 16px; } ul, li { margin-top: 6px }'\r\n    const data = `<html><head><style>${styles}</style></head><body>${content}</body></html>`\r\n    doExport(data, DataTypes.HTML)\r\n}\r\n\r\nconst convertDataToJsonString = (): string => {\r\n    return JSON.stringify(getAllTasks(), null, 2)\r\n}\r\n\r\nconst getExportFileName = (type: DataTypes) => {\r\n    const timestamp = new Date().toISOString()\r\n    return `todolist_export_${timestamp}.${type}`\r\n}\r\n\r\nconst convertDataToHtmlString = (task: Task): string => {\r\n    const textDecoration = task.isDone \r\n        ? 'style=\"text-decoration: line-through\"' \r\n        : ''\r\n\r\n    const subTasksHtml = \r\n        `<ul>${task.subTasks?.map((it) => convertDataToHtmlString(it))}</ul>`\r\n\r\n    return  `<li ${textDecoration}>${task.text + subTasksHtml}</li>`\r\n            .replace(/>,</g, '><')\r\n}\r\n\r\nexport default ExportImport\r\n","import { memo } from 'react'\r\nimport './Button.scss'\r\nimport { MdMenu } from 'react-icons/md'\r\n\r\ntype Props = {\r\n    action: () => void\r\n    classNames?: string[]\r\n    title?: string\r\n}\r\n\r\nconst MenuButton = (props: Props) => {\r\n    const {\r\n        action,\r\n        classNames = [],\r\n        title = ''\r\n    } = props\r\n\r\n    const handleClick = (e: any) => {\r\n        e.stopPropagation()\r\n        action()\r\n    }\r\n\r\n    return (\r\n        <MdMenu \r\n            className={`common-btn ${classNames.join(' ')}`} \r\n            onClick={handleClick}\r\n            title={title}\r\n        />\r\n    )\r\n}\r\n\r\nexport default memo(MenuButton)\r\n","import { useEffect } from \"react\"\r\nimport { createPortal } from \"react-dom\"\r\n\r\ntype Props = { children: any }\r\n\r\nconst Portal = ({ children }: Props) => {\r\n  const mountPoint = document.getElementById(\"portal-root\")\r\n  const el = document.createElement(\"div\")\r\n\r\n  useEffect(() => {\r\n    mountPoint!.appendChild(el)\r\n\r\n    return () => {\r\n        mountPoint!.removeChild(el)\r\n    }\r\n  }, [el, mountPoint])\r\n\r\n  return createPortal(children, el)\r\n};\r\n\r\nexport default Portal","import './withModal.scss'\r\nimport Fog from '../components/Fog/Fog'\r\n\r\nconst withModal = <P extends object>(WrapedComponent: React.ComponentType<P>) => {\r\n\r\n    return (props: any) => (\r\n        <>\r\n            <Fog isDisplayed={true} />\r\n            <div className=\"modal-container\">\r\n                <div className=\"modal-dialog\">\r\n                    <WrapedComponent {...props} />\r\n                </div>\r\n            </div>\r\n        </>\r\n    )\r\n}\r\n\r\nexport default withModal\r\n","import { forwardRef } from 'react'\r\nimport './Button.scss'\r\n\r\ntype Props = {\r\n    text: string\r\n    action: (e: any) => void\r\n    isOutlined?: boolean\r\n    classNames?: string[]\r\n}\r\n\r\nconst Button = (props: Props, ref?: React.ForwardedRef<HTMLButtonElement>) => {\r\n    const {\r\n        text,\r\n        action,\r\n        isOutlined = false,\r\n        classNames = []\r\n    } = props\r\n\r\n    const classes = [ \r\n        'button',\r\n        isOutlined ? 'outlined-btn' : 'filled-btn',\r\n        ...classNames\r\n    ].join(' ')\r\n    \r\n    return (\r\n        <button \r\n            className={classes}\r\n            onClick={action}\r\n            ref={ref}\r\n        >\r\n            {text}\r\n        </button>\r\n    )\r\n}\r\n\r\nexport default forwardRef(Button)\r\n","import withModal from \"../../HOCs/withModal\"\r\nimport { useEffect, useRef } from \"react\"\r\nimport Button from \"../Buttons/Button\"\r\n\r\ntype Props = {\r\n    onConfirm: () => void\r\n    onCancel: () => void\r\n}\r\n\r\nconst ImportModal = (props: Props) => {\r\n    const {\r\n        onConfirm,\r\n        onCancel\r\n    } = props\r\n\r\n    const cancelRef = useRef<HTMLButtonElement>(null)\r\n\r\n    useEffect(() => { setTimeout(() => cancelRef.current?.focus(), 0) })\r\n\r\n    return (\r\n        <>\r\n            <div>Do you want to overwrite existing data?</div>\r\n            <div className=\"modal-btns\">\r\n                <Button \r\n                    text='cancel' \r\n                    ref={cancelRef} \r\n                    action={onCancel} \r\n                    isOutlined\r\n                    classNames={['central-btn']}\r\n                />\r\n                <Button \r\n                    text='ok' \r\n                    action={onConfirm} \r\n                />\r\n            </div>\r\n        </>\r\n    )\r\n}\r\n\r\nexport default withModal(ImportModal)\r\n","import { useRef } from 'react'\r\nimport DropboxConnector from '../../classes/DropboxConnector'\r\nimport { FailureBanner, SuccessBanner } from '../Banner/Banner'\r\nimport syncer from '../../classes/Syncer'\r\nimport { GoArrowRight } from \"react-icons/go\";\r\nimport Button from '../Buttons/Button'\r\nimport { store } from '../../classes/Store'\r\n\r\nconst DropboxSettings = () => {\r\n    const dbx = new DropboxConnector()\r\n\r\n    const authTokenRef = useRef<HTMLInputElement>(null)\r\n\r\n    const authorizeApp = async () => {\r\n        store.showLoading = true\r\n        try {\r\n            await dbx.authorize(authTokenRef.current?.value)\r\n\r\n            syncer.init(dbx)\r\n            store.banner = new SuccessBanner('Application successfully authorized')\r\n        } catch(e) {\r\n            store.banner = new FailureBanner('Error: ' + e.message)\r\n        }\r\n        store.showLoading = false\r\n    }\r\n\r\n    return (\r\n        <>\r\n            <h3>\r\n                Connect Dropbox\r\n                {dbx.isConfigured\r\n                    ? <span className=\"is-authorized already-authorized\" title=\"Already configured\">\r\n                        &#10004;\r\n                    </span>\r\n                    : <span className=\"is-authorized not-authorized\" title=\"Not configured\">\r\n                        !\r\n                    </span>\r\n                }\r\n            </h3>\r\n            <div className=\"dropbox-flow\">\r\n                <Button text='get code' action={()=> window.open(dbx.authUrl, \"_blank\")} />\r\n                <GoArrowRight className=\"arrow-right\" />\r\n                <input \r\n                    type=\"text\" \r\n                    size={48} \r\n                    placeholder=\"insert authorizarion code here\"\r\n                    ref={authTokenRef}\r\n                    className=\"auth-code\"\r\n                />\r\n                <GoArrowRight className=\"arrow-right\" />\r\n                <Button text='authorize' action={authorizeApp} />\r\n            </div>\r\n        </>\r\n    )\r\n}\r\n\r\nexport default DropboxSettings\r\n","import { useState } from 'react'\r\nimport * as lsUtils from '../../utils/localStorageUtils'\r\nimport syncer, { SyncTargets } from '../../classes/Syncer'\r\nimport { SyncStatuses } from '../Statuses/SyncStatus'\r\nimport DropboxSettings from './DropboxSettings'\r\nimport { usePropertyWithState } from '../../classes/Store'\r\n\r\nfunction SyncSettings() {\r\n    const [ syncTarget, setSyncTarget ] = useState(lsUtils.getSyncTarget())\r\n\r\n    const [ syncStatus, setSynStatus ] = usePropertyWithState('syncStatus')\r\n\r\n    const isSelectDisabled = syncStatus === SyncStatuses.InProgress\r\n\r\n    const getTargetSettingsElement = () => {\r\n        switch (syncTarget) {\r\n            case SyncTargets.Dropbox:\r\n                return <DropboxSettings />\r\n            default:\r\n                return null\r\n        }\r\n    }\r\n\r\n    const handleTargetChange = (e: any) => {\r\n        const target = e.target.value as SyncTargets\r\n\r\n        if (target === SyncTargets.Disabled) {\r\n            setSynStatus(SyncStatuses.NotConfigured)\r\n        }\r\n            \r\n        setSyncTarget(target)\r\n        lsUtils.setSyncTarget(target)\r\n        syncer.init()\r\n    }  \r\n\r\n    return (\r\n        <div className=\"settings-block\">\r\n            <h2>Cloud Synchronization</h2>\r\n            <select \r\n                disabled={isSelectDisabled} \r\n                value={syncTarget} \r\n                onChange={handleTargetChange}\r\n            >\r\n                <option value={SyncTargets.Disabled}>Disabled</option>\r\n                <option value={SyncTargets.Dropbox}>Dropbox</option>\r\n            </select>\r\n            {getTargetSettingsElement()}\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default SyncSettings\r\n","import './Settings.scss'\r\nimport ExportImport from './ExportImport' \r\nimport SyncSettings from './SyncSettings'\r\n\r\ntype Props = {\r\n    backToTaskList(): void\r\n}\r\n\r\nconst Settings = (props: Props) => {\r\n\r\n    const { backToTaskList } = props\r\n\r\n    return (\r\n        <div className=\"settings\">\r\n            <ExportImport backToTaskList={backToTaskList} />\r\n            <div className=\"divider\" />\r\n            <SyncSettings />\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Settings\r\n","import Banner from '../Banner/Banner'\r\nimport MenuButton from '../Buttons/MenuButton'\r\nimport { RiSettingsLine } from 'react-icons/ri'\r\nimport Fog from '../Fog/Fog'\r\nimport Settings from '../Settings/Settings'\r\nimport SyncStatus from '../Statuses/SyncStatus'\r\nimport { BsBoxArrowLeft } from 'react-icons/bs'\r\nimport RecordList from '../RecordList/RecordList'\r\n\r\ntype Props = {\r\n    isSidebarOpened: boolean,\r\n    isSettingsOpened: boolean,\r\n    openSidebar: () => void,\r\n    toggleSettings: () => void,\r\n    projectId: string\r\n}\r\n\r\nconst Content = (props: Props) => {\r\n    const { \r\n        isSettingsOpened, \r\n        isSidebarOpened, \r\n        openSidebar,\r\n        toggleSettings,\r\n        projectId\r\n    } = props\r\n\r\n    return (\r\n        <div className=\"right-panel\">\r\n            <Fog isDisplayed={isSidebarOpened} />\r\n            <Banner />\r\n            <div className=\"top-panel\">\r\n                {!isSettingsOpened &&\r\n                    <div className=\"row-btns\">\r\n                        <MenuButton \r\n                            action={openSidebar} \r\n                            classNames={['open-menu-btn']}\r\n                            title=\"open projects list\"\r\n                        />\r\n                    </div>\r\n                }\r\n                <div className=\"row-btns\">\r\n                    <SyncStatus />\r\n                    {isSettingsOpened \r\n                        ? <BsBoxArrowLeft \r\n                            className=\"common-btn close settings\"\r\n                            onClick={toggleSettings}\r\n                            title=\"close settings\"\r\n                          />\r\n                        : <RiSettingsLine \r\n                            className=\"common-btn \"\r\n                            onClick={toggleSettings}\r\n                            title=\"settings\"\r\n                          />\r\n                    }\r\n                </div>\r\n            </div>\r\n            <div className=\"right-content\">\r\n                {isSettingsOpened \r\n                    ? <Settings backToTaskList={toggleSettings} />\r\n                    : projectId && <RecordList rootId={projectId} hasTitle />\r\n                }\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Content\r\n","import { useEffect, useState } from 'react'\r\nimport './MainContainer.scss'\r\nimport Loading from '../Statuses/Loading'\r\nimport syncer from '../../classes/Syncer'\r\nimport Sidebar from '../Sidebar/Sidebar'\r\nimport Content from './Content'\r\nimport { \r\n    usePropertyWithState, \r\n    useReload, \r\n    initSelectProjectId \r\n} from '../../classes/Store'\r\nimport * as lsUtils from \"../../utils/localStorageUtils\"\r\n\r\nconst MainContainer = () => {\r\n    const [ isSettingsOpened, setIsSettingsOpened ] = useState(false)\r\n    const [ isSidebarOpened, setIsSidebarOpened ] = useState(false)\r\n\r\n    const [ selectedProjectId, setSelectedProjectId ] \r\n        = usePropertyWithState('selectedProjectId')\r\n\r\n    useReload(() => setSelectedProjectId(initSelectProjectId()))    \r\n\r\n    useEffect(() => { syncer.init() }, [])\r\n\r\n    // useEffect(() => lsUtils.setSelectedProjectId(selectedProjectId))\r\n\r\n    lsUtils.setSelectedProjectId(selectedProjectId)\r\n\r\n    const toggleSettings = () => setIsSettingsOpened(!isSettingsOpened)\r\n\r\n    const openSidebar = () => {\r\n        setIsSidebarOpened(true)        \r\n        !window.iAmRunningOnMobile && window.addEventListener('resize', closeSidebar)\r\n    }\r\n\r\n    const closeSidebar = () => {\r\n        setIsSidebarOpened(false)\r\n        window.removeEventListener('resize', closeSidebar)\r\n    }\r\n\r\n    return (\r\n        <div className={`main-container${isSidebarOpened ? ' sidebar-opened' : ''}`}>   \r\n            <Loading />\r\n            <Sidebar \r\n                isOpened={isSidebarOpened} \r\n                close={closeSidebar} \r\n                isSettingsOpened={isSettingsOpened}\r\n                projectId={selectedProjectId}\r\n            />\r\n            <Content \r\n                isSettingsOpened={isSettingsOpened}\r\n                isSidebarOpened={isSidebarOpened}\r\n                toggleSettings={toggleSettings}\r\n                openSidebar={openSidebar}\r\n                projectId={selectedProjectId}\r\n            />\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default MainContainer\r\n","import MainContainer from './components/MainContainer/MainContainer';\r\nimport { isMobile } from './utils/commonUtils';\r\n\r\ndeclare global { interface Window { iAmRunningOnMobile: boolean } }\r\nwindow.iAmRunningOnMobile = isMobile()\r\n\r\nconst App = () => (\r\n    <>\r\n        <div id=\"portal-root\"></div>\r\n        <MainContainer />\r\n    </>\r\n)\r\n\r\nexport default App;\r\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://cra.link/PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(/^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://cra.link/PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then((registration) => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://cra.link/PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch((error) => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then((response) => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then((registration) => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log('No internet connection found. App is running in offline mode.');\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then((registration) => {\n        registration.unregister();\n      })\n      .catch((error) => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.scss';\nimport App from './App';\nimport * as serviceWorkerRegistration from './serviceWorkerRegistration';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorkerRegistration.register();\n"],"sourceRoot":""}