{"version":3,"sources":["classes/Task.ts","components/Fog/Fog.tsx","components/Statuses/Spinner.tsx","services/localStorageService.ts","utils/commonUtils.ts","classes/Syncer.ts","classes/Metadata.ts","services/taskService.ts","classes/DropboxClient.ts","classes/DropboxConnector.ts","components/Statuses/SyncStatus.tsx","classes/Store.ts","classes/StoreFactory.ts","components/Statuses/Loading.tsx","components/Banner/Banner.tsx","utils/customHooks.ts","components/Record/AddRecord.tsx","components/Buttons/CheckmarkButton.tsx","components/RecordMenu/DeleteRecords.tsx","components/RecordMenu/Priority.tsx","components/RecordMenu/AddSubtask.tsx","components/RecordMenu/RecordMenu.tsx","components/Record/Editable.tsx","components/Record/Record.tsx","components/RecordList/Title.tsx","components/RecordList/RecordList.tsx","components/Sidebar/Sidebar.tsx","version.js","components/Settings/ExportImport.tsx","components/Buttons/MenuButton.tsx","HOCs/Portal.tsx","HOCs/withModal.tsx","components/Buttons/Button.tsx","components/Settings/ImportModal.tsx","components/Settings/DropboxSettings.tsx","components/Settings/SyncSettings.tsx","components/Settings/Settings.tsx","components/MainContainer/Content.tsx","components/MainContainer/MainContainer.tsx","App.tsx","serviceWorkerRegistration.ts","index.tsx"],"names":["Priorities","Fog","props","isDisplayed","className","style","display","Spinner","customClass","METADATA_KEY","SELECTED_PROJECT_ID_KEY","SETTINGS_KEY","TOKENS_KEY","hasItem","key","localStorage","getItem","getObject","JSON","parse","setObject","obj","setItem","stringify","setSelectedProjectId","id","getSettings","getSyncTarget","syncTarget","setSyncTarget","getTokens","setDropboxToken","dropboxAccessToken","readFile","blob","Promise","resolve","reject","fr","FileReader","onerror","onload","result","readAsText","generateId","length","Math","floor","random","toString","substring","SyncTargets","Task","text","isDone","priority","updatedAt","parentId","subTasks","Trivial","Date","now","this","ROOT_ID","Metadata","taskList","created","deleted","updated","item","p","u","push","includes","filter","it","isRoot","addToTaskList","addToCreated","save","removeFromTaskList","removeFromCreated","addToDeleted","getAllTaskIds","reduce","acc","curr","Object","values","some","taskId","taskMetaRecord","keys","metadata","ls","restore","hasRoot","getTask","getTaskList","taskIds","getSubTasksList","childrenIds","getChildrenIds","getTasksTree","root","addSubTasks","parent","forEach","task","updateTask","registerUpdated","createTask","registerCreated","createTasks","tasks","deleteTask","isProject","store","selectedProjectId","removeItem","registerDeleted","TOKEN_URL","DropboxClient","clientId","codeVerifier","dropbox","initDropbox","validateConfiguration","checkUser","query","authorizationCode","body","URLSearchParams","code","grant_type","client_id","code_verifier","fetch","method","headers","response","json","resData","ok","Error","error_description","accessToken","access_token","path","filesListFolder","filesDownload","contents","filesUpload","mode","filesDeleteV2","token","Dropbox","DATA_FOLDER_PATH","METADATA_FILE_PATH","DropboxConnector","dropboxClient","authorize","check","names","files","name","downloadFile","fileBlob","fileContent","console","log","isFileNotFound","file","uploadFile","deleteFile","e","error","error_summary","authUrl","isConfigured","SyncStatuses","syncer","cloudConnector","isSyncFaild","interval","processChanges","local","remote","localList","remoteList","hasOwnProperty","remoteUpdatedAt","localUpdatedAt","addToUpdated","syncChanges","a","toDownload","concat","toUpload","toDeleteLocal","toDeleteRemote","isRemoteModified","isLocalModified","downloadItems","items","taskService","filesToUpload","map","uploadItems","deleteItems","reset","reload","uploadRemoteMeta","metaLocal","Disabled","createCloudConnector","clearInterval","sync","setInterval","bind","syncStatus","InProgress","fetchRemoteMeta","metaRemote","Failure","Idle","message","toLowerCase","NotConfigured","downloadMetadata","taskListStr","uploadMetadata","SyncStatus","usePropertyWithState","status","refresh","baseClass","noHoverClass","title","onClick","getStatusElement","init","initRoot","Events","initSelectProjectId","getProjectsList","initialValue","subsciptions","Map","notify","eventOrProperty","value","get","callback","Proxy","set","target","property","useSubscribe","useEffect","callbacks","subscribe","newCallbacks","unsubscribe","useEvent","eventName","useProperty","useState","state","setState","useReload","createStore","showLoading","banner","BannerTypes","Loading","spinnerClass","useOutsideClickDetector","ref","action","isEnabled","handleClickOutside","current","contains","document","addEventListener","removeEventListener","AddRecord","add","contentEditable","suppressContentEditableWarning","onInput","textContent","trim","onKeyPress","preventEnterOnEmpty","preventDefault","memo","CheckmarkButton","actionOnClick","isChecked","classes","join","DeleteRecords","isBulk","isDisabled","closeMenu","remove","showDeleteConfirmation","setShowDeleteConfirmation","closeDeleteConfirmation","stopPropagation","confirmRef","useRef","configSingle","icon","tooltip","deleteAction","configBulk","DeleteCompleted","classNames","PRIORITY_NAMES","Minor","Normal","Major","Critical","undefined","Priority","update","showSelector","setShowSelector","switchRef","el","newPrio","parseInt","AddSubtask","showSubtasks","RecordMenu","closeTimeout","showMenu","setShowMenu","menuRef","onMouseLeave","setTimeout","onMouseEnter","clearTimeout","debounceInput","timeout","innerHTML","setCaretPosition","pos","range","createRange","selection","window","getSelection","elContentNode","childNodes","textLength","positionNormalized","min","setStart","collapse","removeAllRanges","addRange","Editable","isEditable","getFocus","isSingleLine","editableRef","setContentEditable","focus","flag","setAttribute","handleInput","onBlur","Record","isSelected","isFocused","hasSubtasks","hasChildren","setShowSubtasks","setText","SetProjectByTitle","updateTitle","SetTitleByProject","recordClassName","hiddenBtnClassName","iAmRunningOnMobile","openSubtasks","closeSubtasks","button","getSubtasksBtn","rootId","Title","setTitle","RecordList","hasTitle","projectId","setRoot","setSubTasks","setData","focusedItemId","isRootList","addSubTask","useCallback","newSubTasks","updateSubTask","deleteSubTask","isSelectedPojectDeleted","deleteCompletedSubTask","idsToDelete","sort","b","pa","pb","activeTasks","t","completedTasks","activeItemListRef","Sidebar","isOpened","close","isSettingsOpened","leftPanelRef","getAttribute","Banner","setBanner","delay","type","DataTypes","FailureBanner","SuccessBanner","Success","MenuButton","Portal","children","mountPoint","getElementById","createElement","appendChild","removeChild","createPortal","withModal","WrapedComponent","Button","isOutlined","forwardRef","onConfirm","onCancel","cancelRef","doExport","data","dataToExport","encodedUri","encodeURI","link","getExportFileName","click","exportDataAsJson","convertDataToJsonString","exportDataAsHtml","taskTree","content","convertDataToHtmlString","HTML","timestamp","toISOString","textDecoration","subTasksHtml","replace","ExportImport","showModal","setShowModal","backToTaskList","fileInputRef","dataType","doImport","clearFileInput","onChange","toUpperCase","accept","DropboxSettings","dbx","authTokenRef","authorizeApp","open","size","placeholder","SyncSettings","setSynStatus","isSelectDisabled","disabled","getTargetSettingsElement","Settings","Content","isSidebarOpened","openSidebar","toggleSettings","MainContainer","setIsSettingsOpened","setIsSidebarOpened","closeSidebar","navigator","maxTouchPoints","msMaxTouchPoints","mQ","matchMedia","media","matches","test","userAgent","isMobile","App","isLocalhost","Boolean","location","hostname","match","registerValidSW","swUrl","config","serviceWorker","register","then","registration","onupdatefound","installingWorker","installing","onstatechange","controller","onUpdate","onSuccess","catch","ReactDOM","render","StrictMode","URL","process","href","origin","contentType","indexOf","ready","unregister","checkValidServiceWorker","serviceWorkerRegistration"],"mappings":"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","file":"static/js/main.71b92540.chunk.js","sourcesContent":["import { generateId } from '../utils/commonUtils';\r\n\r\nexport enum Priorities {\r\n    Trivial,\r\n    Minor,\r\n    Normal,\r\n    Major,\r\n    Critical\r\n}\r\n\r\nexport default class Task {\r\n    text: string\r\n    isDone: boolean\r\n    priority: Priorities\r\n    id: string\r\n    updatedAt: number\r\n    parentId: string | null\r\n    subTasks?: Task[] // for getting tasksTree for HTML export\r\n\r\n    constructor(props: any = {}) {\r\n        const {\r\n            id = generateId(), \r\n            text = '', \r\n            isDone = false, \r\n            priority = Priorities.Trivial, \r\n            updatedAt = Date.now(),\r\n            parentId = null\r\n        } = props\r\n\r\n        this.id = id\r\n        this.text = text\r\n        this.isDone = isDone\r\n        this.priority = priority\r\n        this.updatedAt = updatedAt\r\n        this.parentId = parentId\r\n    }\r\n}\r\n","import './Fog.scss'\r\n\r\ntype Props = {\r\n    isDisplayed: Boolean\r\n}\r\n\r\nconst Fog = (props: Props) => {\r\n    const { isDisplayed = false } = props\r\n\r\n    return <div className=\"fog\" style={{display: isDisplayed ? 'block' : 'none'}}/>\r\n}\r\n\r\nexport default Fog","import './Spinner.scss'\r\n\r\ntype Props = {\r\n    customClass?: string\r\n}\r\n\r\nconst Spinner = (props: Props) =>\r\n    <div className={`spinner ${props.customClass || ''}`} />\r\n\r\nexport default Spinner","import { SyncTargets } from '../classes/Syncer';\r\n\r\nconst METADATA_KEY = 'metadata'\r\nconst SELECTED_PROJECT_ID_KEY = 'selectedProjectId'\r\nconst SETTINGS_KEY = 'settings'\r\nconst TOKENS_KEY = 'tokens'\r\n\r\nexport const hasItem = (key: string): boolean => {\r\n    return !!localStorage.getItem(key)\r\n}\r\n\r\nexport const getObject = (key: string): any => {\r\n    return JSON.parse(localStorage.getItem(key) || '{}')\r\n}\r\n\r\nexport const setObject = (key: string, obj: any): void => {\r\n    localStorage.setItem(key, JSON.stringify(obj))\r\n}\r\n\r\nexport const removeItem = (key: string) => {\r\n    localStorage.removeItem(key)\r\n}\r\n\r\nexport const setSelectedProjectId = (id: string): void => {\r\n    localStorage.setItem(SELECTED_PROJECT_ID_KEY, id)\r\n}\r\n\r\nexport const getSelectedProjectId = (): string => {\r\n    return localStorage.getItem(SELECTED_PROJECT_ID_KEY) || ''\r\n}\r\n\r\nconst getSettings = (): any => { \r\n    return getObject(SETTINGS_KEY)   \r\n}\r\n\r\nexport const getSyncTarget = (): SyncTargets => {\r\n    return getSettings().syncTarget as SyncTargets\r\n}\r\n\r\nexport const setSyncTarget = (syncTarget: SyncTargets): void => {\r\n    setObject(SETTINGS_KEY, { ...getSettings(), syncTarget })\r\n}\r\n\r\nconst getTokens = (): any => {\r\n    return getObject(TOKENS_KEY)\r\n}\r\n\r\nexport const getDropboxToken = (): string => {\r\n    return getTokens().dropboxAccessToken\r\n}\r\n\r\nexport const setDropboxToken = (dropboxAccessToken: string): void => {\r\n    setObject(TOKENS_KEY, { ...getTokens(), dropboxAccessToken })\r\n}\r\n\r\nexport const getMetadada = (): any => {\r\n    return getObject(METADATA_KEY)\r\n}\r\n\r\nexport const setMetadada = (metadata: any) => {\r\n    setObject(METADATA_KEY, metadata)\r\n}\r\n\r\nexport const hasMetadata = (): boolean => {\r\n    return hasItem(METADATA_KEY)\r\n}\r\n","export const isMobile = () => {\r\n    if (navigator.maxTouchPoints) return navigator.maxTouchPoints > 0\r\n    if (navigator.msMaxTouchPoints) return navigator.msMaxTouchPoints > 0\r\n\r\n    const mQ = window.matchMedia && matchMedia(\"(pointer:coarse)\")\r\n    if (mQ && mQ.media === \"(pointer:coarse)\") return !!mQ.matches\r\n\r\n    if ('orientation' in window) return true\r\n\r\n    return (/\\b(BlackBerry|webOS|iPhone|IEMobile)\\b/i.test(navigator.userAgent) ||\r\n            /\\b(Android|Windows Phone|iPad|iPod)\\b/i.test(navigator.userAgent))\r\n}\r\n\r\nexport const readFile = (blob: Blob): Promise<string> => {\r\n    return new Promise((resolve, reject) => {\r\n        const fr = new FileReader()\r\n        fr.onerror = reject\r\n        fr.onload = () => resolve(fr.result as string)\r\n        fr.readAsText(blob)\r\n    })\r\n}\r\n\r\nexport const generateId = (length: number = 10): string => {\r\n    let id = ''\r\n    while (id.length < length) {\r\n        id += Math.floor(Math.random() * 1E10).toString()\r\n    }\r\n    return id.substring(0, length)\r\n}\r\n","import { SyncStatuses } from '../components/Statuses/SyncStatus';\r\nimport DropboxConnector from './DropboxConnector';\r\nimport { reload, store } from './Store'\r\nimport * as ls from \"../services/localStorageService\"\r\nimport * as taskService from '../services/taskService'\r\nimport metaLocal, { Metadata } from './Metadata'\r\n\r\nconst SYNC_INTERVAL_IN_MINUTES = 10\r\n\r\nexport interface ICloudConnector {\r\n    syncTarget: SyncTargets\r\n    authorize: () => any\r\n    check: () => any\r\n    downloadItems: (names: string[]) => Promise<any[]>\r\n    uploadItems: (files: string[][]) => Promise<void>\r\n    deleteItems: (names: string[]) => Promise<void>\r\n    downloadMetadata: () => Promise<string>\r\n    uploadMetadata: (metadata: string) => void\r\n}\r\n\r\nexport enum SyncTargets {\r\n    Dropbox = 'DROPBOX',\r\n    Disabled = 'DISABLED'\r\n}\r\n\r\nclass Syncer {\r\n    private cloudConnector: ICloudConnector | null = null\r\n    private isSyncFaild: boolean = false\r\n    private interval: any = null\r\n\r\n    async init(cloudConnector?: ICloudConnector) {\r\n        if (cloudConnector) {\r\n            this.cloudConnector = cloudConnector\r\n            ls.setSyncTarget(cloudConnector.syncTarget)\r\n        } else {\r\n            const syncTarget = ls.getSyncTarget()\r\n            if (syncTarget === SyncTargets.Disabled) {\r\n                this.cloudConnector = null\r\n            } else {\r\n                this.cloudConnector = this.createCloudConnector(syncTarget)\r\n            }\r\n        }\r\n        \r\n        clearInterval(this.interval)\r\n\r\n        const isConfigured = this.cloudConnector ? await this.check() : false        \r\n\r\n        if (isConfigured) {\r\n            await this.sync()\r\n            this.interval = setInterval(this.sync.bind(this), 60000 * SYNC_INTERVAL_IN_MINUTES)\r\n        }\r\n    }\r\n\r\n    async sync() {\r\n        if (store.syncStatus === SyncStatuses.InProgress) return\r\n\r\n        this.isSyncFaild = false\r\n        store.syncStatus = SyncStatuses.InProgress\r\n\r\n        try {\r\n            const metaRemote = await this.fetchRemoteMeta()\r\n            await this.syncChanges(metaLocal, metaRemote)\r\n        } catch (e) {\r\n            // console.error(e);\r\n            this.isSyncFaild = true\r\n        }\r\n\r\n        store.syncStatus = this.isSyncFaild\r\n            ? SyncStatuses.Failure\r\n            : SyncStatuses.Idle\r\n    }\r\n\r\n    private async check(): Promise<boolean> {\r\n        try {\r\n            await this.cloudConnector!.check()\r\n        } catch(e) {\r\n            if (e.message.toLowerCase().includes('not_configured')) {\r\n                store.syncStatus = SyncStatuses.NotConfigured\r\n                return false\r\n            } else {\r\n                store.syncStatus = SyncStatuses.Failure\r\n                return true\r\n            }\r\n        }\r\n        return true\r\n    }\r\n\r\n    private createCloudConnector(syncTarget?: SyncTargets) {\r\n        switch (syncTarget) {\r\n            case SyncTargets.Dropbox:\r\n                return new DropboxConnector()\r\n            default:\r\n                return null\r\n        }\r\n    }\r\n\r\n    private async fetchRemoteMeta(): Promise<Metadata> {\r\n        const taskListStr = await this.cloudConnector?.downloadMetadata() || '{}'\r\n        const taskList = JSON.parse(taskListStr)\r\n        return new Metadata(taskList)\r\n    }\r\n\r\n    private uploadRemoteMeta(metadata: Metadata) {\r\n        const taskListStr = JSON.stringify(metadata.taskList)\r\n        this.cloudConnector?.uploadMetadata(taskListStr)\r\n    }\r\n\r\n    private processChanges = (local: Metadata, remote: Metadata) => {\r\n        const localList = local.taskList\r\n        const remoteList = remote.taskList\r\n\r\n        if (!Object.keys(remoteList).length) {\r\n            local.created = Object.keys(localList)\r\n            local.deleted = []\r\n            return\r\n        }\r\n      \r\n        local.created.forEach((it) => { remoteList[it] = localList[it] })\r\n        local.deleted.forEach((it) => { remote.removeFromTaskList(it) })\r\n\r\n        Object.keys(localList).forEach((it) => {\r\n            if (!remoteList.hasOwnProperty(it)) {\r\n                remote.addToDeleted(it)\r\n                return\r\n            }\r\n      \r\n            const remoteUpdatedAt = remoteList[it].u\r\n            const localUpdatedAt =  localList[it].u\r\n            if (remoteUpdatedAt > localUpdatedAt) {\r\n                remote.addToUpdated(it)\r\n            } else if (remoteUpdatedAt < localUpdatedAt) {\r\n                local.addToUpdated(it)\r\n            }\r\n        })\r\n      \r\n        Object.keys(remoteList).forEach((it) => {\r\n            if (!localList.hasOwnProperty(it)) {\r\n                remote.addToCreated(it)\r\n            }\r\n        })\r\n    }\r\n\r\n    private syncChanges = async (local: Metadata, remote: Metadata) => {\r\n        this.processChanges(local, remote)\r\n\r\n        const toDownload = remote.created.concat(remote.updated)\r\n        const toUpload = local.created.concat(local.updated)\r\n        const toDeleteLocal = remote.deleted\r\n        const toDeleteRemote = local.deleted\r\n\r\n        console.log('TO DELETE REMOTE', toDeleteRemote.length);\r\n        \r\n    \r\n        const isRemoteModified = toUpload.length || toDeleteRemote.length\r\n        const isLocalModified = toDownload.length || toDeleteLocal.length\r\n\r\n        const items = await this.cloudConnector?.downloadItems(toDownload)\r\n        items?.forEach((it) => taskService.createTask(it))\r\n \r\n        const filesToUpload = toUpload.map((it) => {\r\n            const fileContent = localStorage.getItem(it) || ''\r\n            return [fileContent, it]\r\n        })\r\n        await this.cloudConnector?.uploadItems(filesToUpload)\r\n\r\n        await this.cloudConnector?.deleteItems(toDeleteRemote)\r\n\r\n        toDeleteLocal.forEach((it) => taskService.deleteTask(it))\r\n    \r\n        local.reset()\r\n        local.save()\r\n\r\n        isLocalModified && reload()\r\n\r\n        console.log('NEED TO UPDATE REMOTE: ', isRemoteModified);\r\n        \r\n        (isLocalModified || isRemoteModified) && this.uploadRemoteMeta(metaLocal)\r\n      }\r\n}\r\n\r\nconst syncer = new Syncer()\r\n\r\nexport default syncer\r\n","import * as ls from '../services/localStorageService'\r\n\r\nexport const ROOT_ID = '0'\r\n\r\nexport type Item = {\r\n    id: string\r\n    parentId: string | null\r\n    updatedAt: number\r\n}\r\n\r\nexport type TaskList = { [id: string]: { p: string | null, u: number } }\r\n\r\nexport class Metadata {\r\n    taskList: TaskList\r\n    created: string[] = []\r\n    deleted: string[] = []\r\n    updated: string[] = []\r\n\r\n    constructor(taskList: TaskList = {}) {\r\n        this.taskList = taskList\r\n    }\r\n\r\n    addToTaskList(item: Item): void {\r\n        const { id, parentId, updatedAt } = item\r\n        this.taskList[id] = {\r\n            p: parentId,\r\n            u: updatedAt\r\n        }\r\n    }\r\n\r\n    removeFromTaskList(id: string): void {\r\n        delete this.taskList[id]\r\n    }\r\n\r\n    addToCreated(id: string): void {\r\n        this.created.push(id)\r\n    }\r\n\r\n    removeFromCreated(id: string): void {\r\n        if (this.created.includes(id)) {\r\n            this.created = this.created.filter((it) => it !== id)\r\n        }\r\n    }\r\n\r\n    addToDeleted(id: string): void {\r\n        this.deleted.push(id)\r\n    }\r\n\r\n    addToUpdated(id: string): void {\r\n        this.updated.push(id)\r\n    }\r\n\r\n    registerCreated(item: Item): void {\r\n        if (this.isRoot(item.id)) return\r\n        this.addToTaskList(item)\r\n        this.addToCreated(item.id)\r\n        this.save()\r\n    }\r\n\r\n    registerUpdated(item: Item): void {\r\n        this.addToTaskList(item)\r\n        this.save()\r\n    }\r\n\r\n    registerDeleted(id: string): void {\r\n        this.removeFromTaskList(id)\r\n        this.created.includes(id)\r\n            ? this.removeFromCreated(id)\r\n            : this.addToDeleted(id)\r\n        this.save()\r\n    }\r\n\r\n    getChildrenIds(parentId: string): string[] {\r\n        return this.getAllTaskIds().reduce((acc: string[], curr) => {\r\n            if (this.taskList[curr].p === parentId) acc.push(curr)\r\n            return acc\r\n        }, [])\r\n    }\r\n\r\n    hasChildren(parentId: string): boolean {\r\n        return Object.values(this.taskList).some((it) => it.p === parentId)\r\n    }\r\n\r\n    isProject(taskId: string): boolean {\r\n        const taskMetaRecord = this.taskList[taskId]\r\n        return taskMetaRecord && taskMetaRecord.p === ROOT_ID\r\n    }\r\n\r\n    isRoot(taskId: string): boolean {\r\n        return taskId === ROOT_ID\r\n    }\r\n\r\n    getAllTaskIds(): string[] {\r\n        return Object.keys(this.taskList)\r\n    }\r\n\r\n    save(): void {\r\n        const metadata = {\r\n            taskList: this.taskList,\r\n            created: this.created,\r\n            deleted: this.deleted\r\n        }\r\n        ls.setMetadada(metadata)\r\n    }\r\n\r\n    restore(): void {\r\n        const metadata = ls.getMetadada()\r\n        this.taskList = metadata.taskList\r\n        this.created = metadata.created\r\n        this.deleted = metadata.deleted\r\n    }\r\n\r\n    reset(): void {\r\n        this.created = []\r\n        this.deleted = []\r\n        this.updated = []\r\n        this.save()\r\n    }\r\n\r\n    init(): void {\r\n        ls.hasMetadata()\r\n            ? this.restore() \r\n            : this.save()\r\n    }\r\n}\r\n\r\nconst metadata = new Metadata()\r\n\r\nexport default metadata\r\n","import Task from \"../classes/Task\"\r\nimport * as ls from \"./localStorageService\"\r\nimport metadata, { ROOT_ID } from '../classes/Metadata'\r\nimport { store } from '../classes/Store' \r\n\r\nexport const initRoot = () => {\r\n    if (hasRoot()) return\r\n    const root = { \r\n        id: '0', \r\n        text: \"Projects\" \r\n    }\r\n    createTask(new Task(root))\r\n}\r\n\r\nexport const hasRoot = (): boolean => {\r\n    return ls.hasItem(ROOT_ID)\r\n}\r\n\r\nexport const getRoot = () => {\r\n    return getTask(ROOT_ID)\r\n}\r\n\r\nexport const getTask = (taskId: string): Task => {\r\n    return ls.getObject(taskId)\r\n}\r\n\r\nexport const getTaskList = (taskIds: string[]): Task[] => {\r\n    return taskIds.reduce((acc: Task[], curr) => {\r\n        acc.push(getTask(curr))\r\n        return acc\r\n    }, [])\r\n}\r\n\r\nexport const getAllTasks = (): Task[] => {\r\n    return getTaskList(metadata.getAllTaskIds())\r\n}\r\n\r\nexport const getSubTasksList = (parentId: string): Task[] => {\r\n    const childrenIds = metadata.getChildrenIds(parentId)\r\n    return getTaskList(childrenIds)\r\n}\r\n\r\nexport const getProjectsList = (): Task[] => {\r\n    const childrenIds = metadata.getChildrenIds(ROOT_ID)\r\n    return getTaskList(childrenIds)\r\n}\r\n\r\nexport const getTasksTree = () => {\r\n    const addSubTasks = (parent: Task) => {\r\n        parent.subTasks = getSubTasksList(parent.id)\r\n        parent.subTasks.forEach((task) => addSubTasks(task))\r\n    }\r\n    const root = getRoot()\r\n    addSubTasks(root)\r\n    return root\r\n}\r\n\r\nexport const updateTask = (task: Task): void => {\r\n    task.updatedAt = Date.now()\r\n    ls.setObject(task.id, task)\r\n    metadata.registerUpdated(task)\r\n}\r\n\r\nexport const createTask = (task: Task): void => {\r\n    if (!task.updatedAt) task.updatedAt = Date.now()\r\n    ls.setObject(task.id, task)\r\n    metadata.registerCreated(task)\r\n}\r\n\r\nexport const createTasks = (tasks: Task[]): void => {\r\n    tasks.forEach((task) => createTask(task))\r\n}\r\n\r\nexport const deleteTask = (taskId: string): void => {\r\n    if (metadata.isProject(taskId) && store.selectedProjectId === taskId) {\r\n        store.selectedProjectId = ''\r\n        ls.setSelectedProjectId('')\r\n    }\r\n    ls.removeItem(taskId)\r\n    metadata.registerDeleted(taskId)\r\n    metadata.getChildrenIds(taskId).forEach((id) => deleteTask(id))\r\n}\r\n\r\nexport const deleteTasks = (taskIds: string[]): void => {\r\n    taskIds.forEach((id) => deleteTask(id))\r\n}\r\n","import { setDropboxToken, getDropboxToken } from '../services/localStorageService';\r\nimport { Dropbox } from 'dropbox'\r\nimport fetch from 'isomorphic-fetch'\r\nimport { generateId } from '../utils/commonUtils'\r\n\r\nconst AUTH_URL = 'https://www.dropbox.com/oauth2/authorize'\r\nconst TOKEN_URL = 'https://api.dropbox.com/oauth2/token'\r\n\r\nexport default class DropboxClient {\r\n    private clientId: string\r\n    private codeVerifier: string\r\n    private dropbox: Dropbox | null | undefined\r\n\r\n    constructor(clientId: string) {\r\n        this.clientId = clientId\r\n        this.codeVerifier = generateId(43)\r\n        this.initDropbox()\r\n    }\r\n\r\n    async check() {\r\n        this.validateConfiguration()\r\n        await this.dropbox!.checkUser({ query: 'maybedo' })\r\n    }\r\n\r\n    async authorize(authorizationCode: string = '') {\r\n        const body = new URLSearchParams({\r\n            code: authorizationCode,\r\n            grant_type: 'authorization_code',\r\n            client_id: this.clientId,\r\n            code_verifier: this.codeVerifier\r\n        })\r\n    \r\n        const response = await fetch(TOKEN_URL, {\r\n          method: 'POST',\r\n          headers: {\r\n            'Content-Type': 'application/x-www-form-urlencoded',\r\n          },\r\n          body\r\n        })\r\n    \r\n        const resData = await response.json()\r\n\r\n        if (!response.ok) {\r\n            throw new Error(resData.error_description)\r\n        }\r\n    \r\n        const accessToken = resData.access_token\r\n\r\n        setDropboxToken(accessToken)\r\n\r\n        this.initDropbox(accessToken)\r\n    }\r\n\r\n    async listFolder(path?: string) {\r\n        path = path || ''\r\n        this.validateConfiguration()\r\n        return await this.dropbox!.filesListFolder({ path })\r\n    }\r\n\r\n    async downloadFile(path: string) {\r\n        this.validateConfiguration()\r\n        return await this.dropbox!.filesDownload({ path })\r\n    } \r\n    \r\n    async uploadFile(contents: Object, path: string) {\r\n        this.validateConfiguration()\r\n        return await this.dropbox!.filesUpload({ contents, path, mode: {'.tag': 'overwrite'} })\r\n    }\r\n\r\n    async deleteFile(path: string) {\r\n        this.validateConfiguration()\r\n        return await this.dropbox!.filesDeleteV2({ path })\r\n    }\r\n\r\n    get authUrl(): string {\r\n        return `${AUTH_URL}?client_id=${this.clientId}&response_type=code&code_challenge_method=plain&code_challenge=${this.codeVerifier}`\r\n    }\r\n\r\n    get isConfigured(): boolean {\r\n        return !!this.dropbox\r\n    }\r\n\r\n    private initDropbox(token?: string) {\r\n        const accessToken = token || getDropboxToken()\r\n        this.dropbox = accessToken \r\n            ? new Dropbox({ accessToken, fetch })\r\n            : null\r\n    }\r\n\r\n    validateConfiguration() {\r\n        if (!this.dropbox) throw new Error('not_configured')\r\n    }\r\n}\r\n","import { readFile } from '../utils/commonUtils';\r\nimport { ICloudConnector, SyncTargets } from './Syncer';\r\nimport DropboxClient from './DropboxClient'\r\n\r\nconst CLIENT_ID = 'lxn28fv9hhsn7id'\r\n\r\nconst DATA_FOLDER_PATH = '/data'\r\nconst METADATA_FILE_PATH = '/metadata.json'\r\n\r\nexport default class DropboxConnector implements ICloudConnector {\r\n    private dropboxClient: DropboxClient\r\n\r\n    syncTarget = SyncTargets.Dropbox\r\n\r\n    constructor() {\r\n        this.dropboxClient = new DropboxClient(CLIENT_ID)\r\n    }\r\n\r\n    get authUrl(): string {\r\n        return this.dropboxClient.authUrl\r\n    }\r\n\r\n    get isConfigured(): boolean {\r\n        return this.dropboxClient.isConfigured\r\n    }\r\n\r\n    async authorize(authorizationCode?: string)  {\r\n        await this.dropboxClient.authorize(authorizationCode)\r\n    }\r\n\r\n    async check() {\r\n        await this.dropboxClient.check()\r\n    }\r\n\r\n    async downloadItems(names: string[]): Promise<any[]> {\r\n        const files = []\r\n        for (const name of names) {\r\n            const path = `${DATA_FOLDER_PATH}/${name}.json`\r\n            try {\r\n                const response: any = await this.dropboxClient.downloadFile(path)\r\n                const fileContent = await readFile(response.result.fileBlob)\r\n                files.push(JSON.parse(fileContent as string))\r\n            } catch (e) {\r\n                console.log('e in downloadItems catch', e);\r\n                // console.log('path in downloadItems catch', path);\r\n                if (!this.isFileNotFound(e)) throw e\r\n            }  \r\n        }\r\n        return files\r\n    }\r\n\r\n    async uploadItems(files: string[][]): Promise<void> {\r\n        for (const file of files) {\r\n            const path = `${DATA_FOLDER_PATH}/${file[1]}.json`\r\n            await this.dropboxClient.uploadFile(file[0], path)\r\n        }\r\n    }\r\n\r\n    async deleteItems(names: string[]): Promise<void> {\r\n        console.log('deleteItems ITEMS:', names);\r\n        \r\n        for (const name of names) {\r\n            const path = `${DATA_FOLDER_PATH}/${name}.json`    \r\n            try {\r\n                await this.dropboxClient.deleteFile(path)\r\n            } catch (e) {\r\n                // console.log('e in deleteItems catch', e);\r\n                \r\n                if (!this.isFileNotFound(e)) throw e\r\n            }                   \r\n        }\r\n    }\r\n\r\n    async downloadMetadata(): Promise<string> {        \r\n        try {\r\n            const response: any = await this.dropboxClient.downloadFile(METADATA_FILE_PATH)\r\n            return await readFile(response.result.fileBlob)\r\n        } catch(e) {\r\n            return ''\r\n        }\r\n    }\r\n\r\n    async uploadMetadata(metadata: string) {\r\n        await this.dropboxClient.uploadFile(metadata, METADATA_FILE_PATH)\r\n    }\r\n\r\n    isFileNotFound(e: any): boolean {\r\n        // console.log('====================');\r\n        // console.log('e', e.error);\r\n        // console.log('e.error', e.error);\r\n        // console.log('parsed', JSON.parse(e.error));\r\n        return JSON.parse(e.error)\r\n            .error_summary\r\n            .includes('not_found')\r\n    }\r\n}\r\n","import syncer from '../../classes/Syncer'\r\nimport './SyncStatus.scss'\r\nimport { \r\n    MdSyncProblem,\r\n    MdSyncDisabled,\r\n    MdSync\r\n} from 'react-icons/md'\r\nimport { usePropertyWithState } from '../../classes/Store'\r\n\r\nexport enum SyncStatuses {\r\n    NotConfigured = 'NOT_CONFIGURED',\r\n    Idle = 'IDLE',\r\n    InProgress = 'IN_PROGRESS',\r\n    Failure = 'FAILURE'\r\n}\r\n\r\nconst SyncStatus = () => {\r\n    const [ status ] = usePropertyWithState('syncStatus')\r\n\r\n    const refresh = () => syncer.sync()\r\n\r\n    const baseClass = 'material-icons-outlined common-btn'\r\n    const noHoverClass = baseClass + ' no-hover'\r\n    const inProgresClass = noHoverClass + ' syncing'\r\n    const failureClass = baseClass + ' failure'\r\n\r\n    const getStatusElement = (status?: SyncStatuses) => {\r\n        switch (status) {\r\n            case SyncStatuses.NotConfigured:\r\n                return <MdSyncDisabled \r\n                            className={noHoverClass}\r\n                            title=\"cloud sync disabled\"\r\n                        />  \r\n            case SyncStatuses.Idle:\r\n                return <MdSync \r\n                            className={baseClass}\r\n                            onClick={refresh}\r\n                            title=\"synchronize\"\r\n                        />     \r\n            case SyncStatuses.InProgress:\r\n                return <MdSync \r\n                            className={inProgresClass}\r\n                            onClick={refresh}\r\n                            title=\"synchronizing\"\r\n                        />                \r\n            case SyncStatuses.Failure:\r\n                return <MdSyncProblem \r\n                            className={failureClass}\r\n                            onClick={refresh}\r\n                            title=\"sync failed\"\r\n                        />            \r\n            default:\r\n                 return <MdSyncDisabled \r\n                            className={noHoverClass}\r\n                            title=\"cloud sync disabled\"\r\n                        />   \r\n        }\r\n    } \r\n\r\n    return (\r\n        <div className='sync-status'>\r\n            {getStatusElement(status)}\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default SyncStatus\r\n","import { createStore } from './StoreFactory';\r\nimport * as ls from \"../services/localStorageService\"\r\nimport { getProjectsList, initRoot } from '../services/taskService'\r\nimport metadata from './Metadata'\r\nimport { SyncStatuses } from '../components/Statuses/SyncStatus'\r\nimport { IBanner } from '../components/Banner/Banner'\r\n\r\nmetadata.init()\r\ninitRoot()\r\n\r\ntype Store = {\r\n    selectedProjectId: string,\r\n    showLoading: boolean,\r\n    banner: IBanner | null,\r\n    syncStatus: SyncStatuses\r\n}\r\n\r\nexport const initSelectProjectId = () => (\r\n    ls.getSelectedProjectId()\r\n        || getProjectsList()[0]?.id \r\n        || ''\r\n)\r\n\r\nconst initialValue: Store = {\r\n    selectedProjectId: initSelectProjectId(),\r\n    showLoading: false,\r\n    banner: null,\r\n    syncStatus: SyncStatuses.NotConfigured\r\n}\r\n\r\nexport const {\r\n    store,\r\n    notify,\r\n    useEvent,\r\n    usePropertyWithState,\r\n    useReload,\r\n    reload\r\n} = createStore(initialValue)\r\n\r\nexport enum Events {\r\n    SetTitleByProject,\r\n    SetProjectByTitle,\r\n    DeleteCompleted,\r\n} \r\n","import { useEffect, useState } from 'react'\r\n\r\nexport const createStore = <T extends object>(initialValue: T) => {\r\n    type Callback = (value?: any) => void\r\n    type Property = keyof typeof initialValue\r\n    type StoreData = typeof initialValue\r\n\r\n    const subsciptions: Map<string, Callback[]> = new Map()\r\n    \r\n    const subscribe = (eventOrProperty: string, callback: Callback) => {\r\n        const callbacks = subsciptions.get(eventOrProperty)\r\n        callbacks\r\n            ? callbacks.push(callback)\r\n            : subsciptions.set(eventOrProperty, [callback])\r\n    }\r\n\r\n    const unsubscribe = (eventOrProperty: string, callback: Callback) => {\r\n        const callbacks = subsciptions.get(eventOrProperty)\r\n        if (callbacks) {\r\n            const newCallbacks = callbacks.filter((it) => it !== callback)\r\n            subsciptions.set(eventOrProperty as string, newCallbacks)\r\n        }\r\n    }\r\n\r\n    const notify = (eventOrProperty: string, value?: any) => {\r\n        subsciptions.get(eventOrProperty)?.forEach((callback) => callback(value))\r\n    }\r\n\r\n    const toProxy = (obj: StoreData):  StoreData => {\r\n        const proxyHandler = {\r\n            set: (target: any, property: string, value: any) => {\r\n                target[property] = value\r\n                notify(property, value)\r\n                return true\r\n            },\r\n            get: (target: any, property: string) => {\r\n                return target[property]\r\n            }\r\n        }\r\n        return new Proxy(obj, proxyHandler)\r\n    }\r\n\r\n    const store: StoreData = toProxy(initialValue)\r\n\r\n    const useSubscribe = (eventOrProperty: string, callback: Callback) => {  \r\n        useEffect(() => {\r\n            subscribe(eventOrProperty, callback)\r\n            return () => unsubscribe(eventOrProperty, callback)\r\n        }, [callback, eventOrProperty])\r\n    }\r\n\r\n    const useEvent = (eventName: string, callback: Callback): Callback => {  \r\n        useSubscribe(eventName, callback)\r\n        return (value: any) => notify(eventName, value)\r\n    }\r\n\r\n    const useProperty = (property: Property, callback: Callback) => { \r\n        useSubscribe(property as string, callback)\r\n    \r\n        return (value: any) => store[property] = value\r\n    }\r\n    \r\n    const usePropertyWithState = (property: Property, callback?: Callback): [any, Callback] => {  \r\n        const [ state, setState ] = useState(store[property])\r\n    \r\n        const onNotify = (value: any) => {\r\n            callback && callback(value)\r\n            setState(value)\r\n        }\r\n        useProperty(property, onNotify)\r\n    \r\n        return [ state, (value: any) => store[property] = value ]\r\n    }\r\n\r\n    const useReload = (callback: Callback) => {\r\n        const [ , setState ] = useState({})\r\n\r\n        const onNotify = () => {\r\n            callback && callback()\r\n            setState({})\r\n        }\r\n        \r\n        useEvent('reload', onNotify)\r\n    }\r\n\r\n    const reload = () => notify('reload')\r\n\r\n    return {\r\n        store,\r\n        notify,\r\n        useSubscribe,\r\n        useEvent,\r\n        useProperty,\r\n        usePropertyWithState,\r\n        useReload,\r\n        reload\r\n    }\r\n}\r\n","import Fog from '../Fog/Fog'\r\nimport Spinner from './Spinner'\r\nimport './Loading.scss'\r\nimport { usePropertyWithState } from '../../classes/Store'\r\n\r\ntype Props = {\r\n    spinnerClass?: string\r\n}\r\n\r\nconst Loading = (props: Props) => {\r\n    const { spinnerClass } = props\r\n\r\n    const [ showLoading ] = usePropertyWithState('showLoading')\r\n\r\n    if (!showLoading) return null\r\n    \r\n    return (\r\n        <>\r\n            <Fog isDisplayed={true} />\r\n            <div className=\"loading\">\r\n                <Spinner customClass={spinnerClass} />\r\n            </div>\r\n        </>\r\n    )\r\n}\r\n\r\nexport default Loading\r\n","import { useEffect } from 'react'\r\nimport './Banner.scss'\r\nimport { MdClose } from 'react-icons/md'\r\nimport { usePropertyWithState } from '../../classes/Store'\r\n\r\nconst Banner = () => {\r\n    const [ banner, setBanner ] = usePropertyWithState('banner')\r\n\r\n    useEffect(() => {\r\n        if (banner && banner.delay && banner.delay > 0) {\r\n            setTimeout(() => setBanner(null), banner.delay * 1000)\r\n        }\r\n    }, [banner, setBanner])\r\n\r\n    if (!banner) return null\r\n\r\n    const { text, type } = banner\r\n\r\n    return (\r\n        <div className={`banner banner-${type}`}>\r\n            <div>{text}</div>\r\n            <MdClose onClick={() => setBanner(null)} />\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Banner\r\n\r\nexport interface IBanner {\r\n    text: string\r\n    type: BannerTypes\r\n    delay?: number\r\n}\r\n\r\nexport enum BannerTypes {\r\n    Success = \"success\",\r\n    Warning = \"warning\",\r\n    Failure = \"failure\"\r\n}\r\n\r\nexport class FailureBanner implements IBanner {\r\n    text: string\r\n    type: BannerTypes\r\n\r\n    constructor(text: string) {\r\n        this.text = text\r\n        this.type = BannerTypes.Failure\r\n    }\r\n}\r\n\r\nexport class SuccessBanner implements IBanner {\r\n    text: string\r\n    type: BannerTypes\r\n    delay: number\r\n\r\n    constructor(text: string, delay: number = 5) {\r\n        this.text = text\r\n        this.type = BannerTypes.Success\r\n        this.delay = delay\r\n    }\r\n}\r\n","import { \r\n    MutableRefObject, \r\n    useEffect \r\n} from \"react\"\r\n\r\nexport const useOutsideClickDetector = (\r\n    ref: MutableRefObject<HTMLElement | null>, \r\n    action: Function, \r\n    isEnabled: boolean = true) => \r\n{\r\n    useEffect(() => {\r\n        if (!isEnabled) return\r\n\r\n        const handleClickOutside = (e: any) => {\r\n            if (ref.current && !ref.current.contains(e.target)) {\r\n                action()\r\n            }\r\n        }\r\n\r\n        document.addEventListener(\"mousedown\", handleClickOutside)\r\n\r\n        return () => document.removeEventListener(\"mousedown\", handleClickOutside)\r\n    }, [action, isEnabled, ref])\r\n}\r\n","import { memo } from 'react'\r\nimport './Record.scss'\r\nimport Task from '../../classes/Task'\r\nimport { MdAdd } from 'react-icons/md'\r\n\r\ntype Props = { add: (task: Task) => void }\r\n \r\nconst AddRecord = ({ add }: Props) => {    \r\n    const createRecord = (e: any) => {\r\n        const text = e.target.textContent.trim()\r\n        if (!text) return\r\n        const task = new Task({ text })\r\n        add(task)\r\n        e.target.textContent = ''\r\n    }\r\n\r\n    return (  \r\n        <div className=\"record add-record\">\r\n            <div className=\"row-btns\">\r\n                <MdAdd />\r\n            </div>\r\n            <div \r\n                className=\"item-content\" \r\n                contentEditable=\"true\"\r\n                suppressContentEditableWarning={true}\r\n                onInput={createRecord}\r\n                onKeyPress={preventEnterOnEmpty}\r\n            />\r\n        </div>\r\n    )\r\n}\r\n\r\nconst preventEnterOnEmpty = (e: any) => {\r\n    !e.target.textContent.trim() && e.key === 'Enter' && e.preventDefault()\r\n}\r\n\r\nexport default memo(AddRecord)\r\n","import './Button.scss'\r\nimport { MdCheckBoxOutlineBlank, MdCheckBox } from 'react-icons/md'\r\n\r\ntype Props = {\r\n    actionOnClick: (e: any) => void\r\n    isChecked?: boolean,\r\n    priority: number\r\n}\r\n\r\nconst CheckmarkButton = (props: Props) => {\r\n    const {\r\n        actionOnClick,\r\n        isChecked = false,\r\n        priority\r\n    } = props\r\n\r\n    const classes = [ \r\n        'common-btn', \r\n        'checkmark-btn', \r\n        isChecked ? 'prio-0' : 'prio-' + priority \r\n    ].join(' ')\r\n\r\n    return (\r\n        <>\r\n            {isChecked\r\n                ? <MdCheckBox \r\n                    className={classes} \r\n                    onClick={actionOnClick}\r\n                />\r\n                : <MdCheckBoxOutlineBlank \r\n                    className={classes} \r\n                    onClick={actionOnClick}\r\n                />\r\n            }\r\n        </>\r\n    )\r\n}\r\n\r\nexport default CheckmarkButton\r\n","import { useState, useRef } from \"react\"\r\nimport { RiDeleteBin7Fill, RiDeleteBinFill } from 'react-icons/ri'\r\nimport { MdCheck, MdClose } from \"react-icons/md\"\r\nimport { useOutsideClickDetector } from '../../utils/customHooks'\r\nimport Task from \"../../classes/Task\"\r\nimport { notify, Events } from \"../../classes/Store\"\r\n\r\ntype Props = {\r\n    task: Task,\r\n    isBulk?: boolean,\r\n    isDisabled?: boolean,\r\n    closeMenu?: () => void\r\n    remove: (task: Task) => void\r\n}\r\n\r\nconst DeleteRecords = (props: Props) => {\r\n    const { \r\n        task, \r\n        isBulk = false, \r\n        isDisabled = false,\r\n        closeMenu = () => {},\r\n        remove\r\n     } = props\r\n\r\n    const [ showDeleteConfirmation, setShowDeleteConfirmation ] = useState(false)\r\n\r\n    const deleteRecord = (e: any) => {\r\n        e.stopPropagation()\r\n        setShowDeleteConfirmation(false)\r\n        remove(task)\r\n    }\r\n\r\n    const deleteCompleted = (e: any) => {\r\n        e.stopPropagation()\r\n        setShowDeleteConfirmation(false)\r\n        notify(Events.DeleteCompleted + task.id)\r\n        closeMenu()\r\n    }\r\n\r\n    const openDeleteConfirmation = (e: any) => {\r\n        e && e.stopPropagation()\r\n        setShowDeleteConfirmation(true)\r\n    }\r\n\r\n    const closeDeleteConfirmation = (e: any) => {\r\n        e && e.stopPropagation()\r\n        setShowDeleteConfirmation(false)\r\n    }\r\n\r\n    const confirmRef = useRef(null)\r\n    useOutsideClickDetector(confirmRef, closeDeleteConfirmation, showDeleteConfirmation)\r\n\r\n    const configSingle = {\r\n        icon: <RiDeleteBin7Fill />,\r\n        text: 'Delete',\r\n        tooltip: 'Delete task',\r\n        deleteAction: deleteRecord\r\n    }\r\n    \r\n    const configBulk = {\r\n        icon: <RiDeleteBinFill />,\r\n        text: 'Clear',\r\n        tooltip: 'Delete completed subtasks',\r\n        deleteAction: deleteCompleted\r\n    }\r\n\r\n    const { \r\n        icon, \r\n        text, \r\n        tooltip, \r\n        deleteAction \r\n    } = isBulk ? configBulk : configSingle\r\n\r\n    const classNames = [ 'record-menu-row' ]\r\n    isDisabled && classNames.push('disabled')\r\n\r\n    return (\r\n        <>\r\n            {showDeleteConfirmation \r\n                ?\r\n                <div className=\"record-menu-row\" ref={confirmRef}>\r\n                    <div className=\"inline-menu-btn\">\r\n                        <MdCheck onClick={deleteAction} />\r\n                    </div>\r\n                    <div className=\"inline-menu-btn\">\r\n                        <MdClose onClick={closeDeleteConfirmation} />\r\n                    </div>\r\n                </div>\r\n                :\r\n                <div \r\n                    onClick={openDeleteConfirmation} \r\n                    title={tooltip} \r\n                    className={classNames.join(' ')}\r\n                >\r\n                    {icon}\r\n                    <div className=\"menu-item-text\">{text}</div>\r\n                </div>\r\n            }\r\n        </>\r\n    )\r\n}\r\n\r\nexport default DeleteRecords\r\n","import { useState, useRef } from 'react'\r\nimport Task, { Priorities } from '../../classes/Task'\r\nimport { RiFilePptFill } from 'react-icons/ri'\r\nimport { useOutsideClickDetector } from '../../utils/customHooks'\r\n\r\nconst PRIORITY_NAMES = new Map([\r\n    [Priorities.Trivial, 'Trivial'],\r\n    [Priorities.Minor, 'Minor'],\r\n    [Priorities.Normal, 'Normal'],\r\n    [Priorities.Major, 'Major'],\r\n    [Priorities.Critical, 'Critical'],\r\n    [undefined, 'Trivial'],\r\n])\r\n\r\ntype Props = { \r\n    task: Task,\r\n    closeMenu: () => void,\r\n    update: (task: Task) => void\r\n}\r\n\r\nconst Priority = (props: Props) => {\r\n    const {\r\n        task,\r\n        closeMenu,\r\n        update\r\n    } = props\r\n\r\n    const [ showSelector, setShowSelector ] = useState(false)\r\n\r\n    const openSelector = (e: any) => {\r\n        e.stopPropagation()\r\n        setShowSelector(true)\r\n    }\r\n    const closeSelector = () => setShowSelector(false)\r\n\r\n    const switchRef = useRef(null)\r\n    useOutsideClickDetector(switchRef, closeSelector, showSelector)\r\n\r\n    const handleClickOnSwitch = (e: any) => {\r\n        e.stopPropagation()\r\n\r\n        const el = e.target as HTMLDivElement   \r\n        const newPrio = parseInt(el.textContent!)     \r\n        if (newPrio !== task.priority) {\r\n            task.priority = newPrio\r\n            update(task)\r\n        }\r\n        closeMenu() \r\n    }\r\n\r\n    return (\r\n        <>\r\n            {showSelector \r\n                ? <div \r\n                    className=\"record-menu-row priority-switch\" \r\n                    onClick={handleClickOnSwitch}\r\n                    ref={switchRef} \r\n                >\r\n                    <div className=\"inline-menu-btn\"><div>{Priorities.Trivial}</div></div>\r\n                    <div className=\"inline-menu-btn\"><div>{Priorities.Minor}</div></div>\r\n                    <div className=\"inline-menu-btn\"><div>{Priorities.Normal}</div></div>\r\n                    <div className=\"inline-menu-btn\"><div>{Priorities.Major}</div></div>\r\n                    <div className=\"inline-menu-btn\"><div>{Priorities.Critical}</div></div>\r\n                </div> \r\n                : <div \r\n                    className=\"record-menu-row\" \r\n                    onClick={openSelector} \r\n                    title=\"Set task priotity\"\r\n                >\r\n                    <RiFilePptFill className=\"menu-item-icon\" />\r\n                    <div className=\"menu-item-text\">\r\n                        {PRIORITY_NAMES.get(task.priority)}\r\n                    </div>\r\n                </div>\r\n            }\r\n        </>\r\n    )\r\n}\r\n\r\nexport default Priority\r\n","import { RiFileAddFill } from 'react-icons/ri'\r\n\r\ntype Props = {\r\n    closeMenu: () => void\r\n    showSubtasks: () => void\r\n    isDisabled?: boolean\r\n}\r\n\r\nconst AddSubtask = ({ closeMenu, showSubtasks, isDisabled = false }: Props) => {\r\n    const handleClickOnAddSubtask = () => {\r\n        closeMenu()\r\n        showSubtasks()\r\n    }\r\n\r\n    const classes = [\r\n        'record-menu-row',\r\n        isDisabled ? 'disabled' : ''\r\n    ].join(' ')\r\n\r\n    return (\r\n        <div \r\n            className={classes}\r\n            title=\"Add subtask\" \r\n            onClick={handleClickOnAddSubtask}\r\n        >\r\n            <RiFileAddFill className=\"menu-item-icon\" />\r\n            <div className=\"menu-item-text\">Add</div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default AddSubtask\r\n","import { useRef, useState } from 'react'\r\nimport { MdMoreVert } from \"react-icons/md\"\r\nimport Task from '../../classes/Task'\r\nimport { useOutsideClickDetector } from '../../utils/customHooks'\r\nimport DeleteRecords from './DeleteRecords'\r\nimport Priority from './Priority'\r\nimport './RecordMenu.scss'\r\nimport AddSubtask from './AddSubtask'\r\n\r\ntype Props = {\r\n    task: Task,\r\n    classes?: string[],\r\n    showSubtasks: () => void,\r\n    update: (task: Task) => void,\r\n    remove: (task: Task) => void,\r\n    isProject: boolean,\r\n    isRoot: boolean\r\n}\r\n\r\nconst RecordMenu = (props: Props) => {\r\n    const {\r\n        task,\r\n        classes = [],\r\n        showSubtasks,\r\n        update,\r\n        remove,\r\n        isProject,\r\n        isRoot\r\n    } = props\r\n\r\n    const [ showMenu, setShowMenu ] = useState(false)\r\n\r\n    const openMenu = (e: any) => {\r\n        e.stopPropagation() // prevent task selection on click\r\n        setShowMenu(true)\r\n    }\r\n\r\n    const closeMenu = () => setShowMenu(false)\r\n\r\n    const menuRef = useRef(null)\r\n    useOutsideClickDetector(menuRef, closeMenu, showMenu)\r\n\r\n    let closeTimeout: any\r\n    const handleMouseLeave = () => {\r\n        closeTimeout = setTimeout(closeMenu, 500)\r\n    }\r\n    const handleMouseEnter = () => {\r\n        clearTimeout(closeTimeout)\r\n    }\r\n    \r\n    return (\r\n        <div className={'record-menu-box ' + classes.join(' ')}>\r\n            <MdMoreVert className=\"common-btn\" onClick={openMenu} />\r\n            {showMenu && <div \r\n                className=\"record-menu\"\r\n                ref={menuRef} \r\n                onMouseLeave={handleMouseLeave}\r\n                onMouseEnter={handleMouseEnter}\r\n            >\r\n                {!task.isDone && !isRoot && <Priority \r\n                    task={task} \r\n                    closeMenu={closeMenu} \r\n                    update={update}\r\n                />}\r\n                {!isProject && !task.isDone && !isRoot && <AddSubtask \r\n                    closeMenu={closeMenu}\r\n                    showSubtasks={showSubtasks}\r\n                    isDisabled={false}\r\n                />}\r\n                <DeleteRecords\r\n                    task={task} \r\n                    isBulk\r\n                    isDisabled={false}\r\n                    closeMenu={closeMenu}\r\n                    remove={remove}\r\n                />\r\n                {!isRoot && \r\n                    <DeleteRecords \r\n                        task={task}\r\n                        remove={remove}\r\n                    />\r\n                }\r\n            </div>}\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default RecordMenu\r\n","import { useRef, useEffect } from 'react'\r\n\r\ntype Props = { \r\n    text: string, \r\n    isEditable: boolean,\r\n    update: (text: string) => void,\r\n    getFocus?: boolean, \r\n    isSingleLine?: boolean,\r\n    classes?: string[]\r\n}\r\n\r\nconst Editable = (props: Props) => {\r\n    const {\r\n        text,\r\n        isEditable,\r\n        update,\r\n        getFocus = false,\r\n        isSingleLine = false,\r\n        classes = []\r\n    } = props\r\n\r\n    const editableRef = useRef<HTMLDivElement>(null)\r\n\r\n    useEffect(() => {\r\n        if (editableRef.current) editableRef.current.innerHTML = text\r\n    })\r\n\r\n    useEffect(() => {\r\n        if (getFocus) {        \r\n            setContentEditable(true)\r\n            editableRef.current?.focus()\r\n            setCaretPosition(editableRef.current, text.length)\r\n        }\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, [])\r\n\r\n    const setContentEditable = (flag: boolean) => {\r\n        const el = editableRef.current\r\n        el?.setAttribute('contenteditable', '' + flag)\r\n    }\r\n\r\n    const handleInput = debounceInput(update)\r\n\r\n    const handleBlur = () => !isEditable && setContentEditable(false)\r\n\r\n    const preserveSingleLine = (e: any) => {\r\n        isSingleLine && e.key === 'Enter' && e.preventDefault()\r\n    }\r\n\r\n    const classNames = [ \r\n        ...classes,\r\n        isEditable ? '' : 'read-only'\r\n    ].join(' ')\r\n\r\n    return (\r\n        <div \r\n            ref={editableRef}\r\n            className={classNames}\r\n            contentEditable={isEditable}\r\n            suppressContentEditableWarning={true}\r\n            onInput={handleInput}\r\n            onBlur={handleBlur}\r\n            onKeyPress={preserveSingleLine}\r\n        />\r\n    )\r\n}\r\n\r\nconst debounceInput = (callback: (text: string) => void) => {\r\n    let timeout: any\r\n    return (e: any) => {\r\n        const text = e.target.innerHTML\r\n        clearTimeout(timeout)\r\n        timeout = setTimeout(() => callback(text), 700)\r\n    }\r\n}\r\n\r\nconst setCaretPosition = (el: HTMLElement | null, pos?: number): void => {\r\n    if (!el) return\r\n    const range = document.createRange()\r\n    const selection = window.getSelection()\r\n    const elContentNode = el.childNodes[0]\r\n    if (!elContentNode || !elContentNode.textContent) return\r\n    const textLength = elContentNode.textContent.length\r\n    const positionNormalized = pos !== undefined \r\n        ? Math.min(pos, textLength) \r\n        : textLength\r\n    range.setStart(elContentNode, positionNormalized)\r\n    range.collapse()\r\n    selection?.removeAllRanges()\r\n    selection?.addRange(range)\r\n}\r\n\r\nexport default Editable\r\n","import { useState, memo, useEffect } from 'react'\r\nimport './Record.scss'\r\nimport Task from '../../classes/Task'\r\nimport CheckmarkButton from '../Buttons/CheckmarkButton'\r\nimport { MdExpandLess, MdExpandMore } from 'react-icons/md'\r\nimport RecordMenu from '../RecordMenu/RecordMenu'\r\nimport Editable from './Editable'\r\nimport { updateTask } from '../../services/taskService'\r\nimport RecordList from '../RecordList/RecordList'\r\nimport { store, useEvent, notify, Events } from '../../classes/Store'\r\nimport metadata from '../../classes/Metadata'\r\n\r\ntype Props = { \r\n    item: Task, \r\n    isEditable?: boolean,\r\n    isSelected?: boolean,\r\n    update?: (task: Task) => void,\r\n    remove?: (task: Task) => void,\r\n    isFocused?: boolean\r\n}\r\n\r\nconst Record = (props: Props) => {\r\n    const {\r\n        isEditable = true,\r\n        isSelected = false,\r\n        isFocused = false,\r\n        item,\r\n        update = () => {},\r\n        remove = () => {},\r\n        item: {\r\n            id, \r\n            isDone,\r\n            priority\r\n        }\r\n    } = props\r\n\r\n    const hasSubtasks = metadata.hasChildren(id)\r\n    const isProject = metadata.isProject(id)\r\n    const isRoot = metadata.isRoot(id)\r\n\r\n    const [ showSubtasks, setShowSubtasks ] = useState(false)\r\n    const [ text, setText ] = useState(item.text)\r\n\r\n    // rerender record after updating from cloud \r\n    useEffect(() => setText(item.text), [item.text])\r\n\r\n    const  updateTextFromTitle = (text: string) => {\r\n        updateTask({ ...item, text})\r\n        setText(text)\r\n    }\r\n\r\n    const updateTextFromEditable = (text: string) => {\r\n        updateTask({ ...item, text})\r\n        isProject && updateTitle(text)\r\n    }\r\n\r\n    useEvent(Events.SetProjectByTitle + id, updateTextFromTitle)\r\n\r\n    const updateTitle = (text: string) => notify(Events.SetTitleByProject + id, text)\r\n    \r\n    const handleClickOnRecord = () => { \r\n        if (isProject && !isRoot) store.selectedProjectId = id\r\n    }\r\n\r\n    const handleClickOnCheckbox = (e: any) => {\r\n        e.stopPropagation()\r\n        if (e.button === 0) { // left click only\r\n            item.isDone = !item.isDone\r\n            update(item)\r\n        }\r\n    }\r\n\r\n    const recordClassName = [\r\n        'record', \r\n        isSelected ? 'record-selected' : '',\r\n        !isEditable ? 'read-only' : '',\r\n        isProject? 'project' : '',\r\n        isDone ? 'item-done' : ''\r\n    ].join(' ')\r\n        \r\n    const hiddenBtnClassName = window.iAmRunningOnMobile ? '' : 'hidden-btn' \r\n\r\n    const openSubtasks = () => {\r\n        setShowSubtasks(true)\r\n    }\r\n\r\n    const closeSubtasks = () => {\r\n        setShowSubtasks(false)\r\n    }\r\n\r\n    const getSubtasksBtn = () => {\r\n        const classes = \"common-btn subtasks-btn\"\r\n        if (hasSubtasks && !showSubtasks) {\r\n            return <MdExpandMore onClick={openSubtasks} className={classes} />\r\n        }\r\n        if (showSubtasks) {\r\n            return <MdExpandLess onClick={closeSubtasks} className={classes} />\r\n        }\r\n        return null\r\n    }\r\n\r\n    return (\r\n        <>\r\n            <div \r\n                className={recordClassName}\r\n                onClick={handleClickOnRecord}\r\n            >\r\n                <div className=\"row-btns\">\r\n                    <CheckmarkButton \r\n                        actionOnClick={handleClickOnCheckbox} \r\n                        isChecked={isDone}\r\n                        priority={priority}\r\n                    />\r\n                </div>\r\n                <Editable \r\n                    text={text} \r\n                    update={updateTextFromEditable} \r\n                    isEditable={isEditable}\r\n                    getFocus={isFocused}\r\n                    classes={[ 'item-content' ]}\r\n                />\r\n                {/* DEBUG: display task ID for each record  */}\r\n                {/* <span style={{fontSize: '10px'}}>{id}</span> */}\r\n                <div className=\"row-btns\">\r\n                    {getSubtasksBtn()}\r\n                    <RecordMenu \r\n                        task={item} \r\n                        showSubtasks={openSubtasks}\r\n                        classes={[ hiddenBtnClassName ]}\r\n                        isProject={isProject}\r\n                        isRoot={isRoot}\r\n                        update={update}\r\n                        remove={remove}\r\n                    /> \r\n                </div>\r\n            </div>\r\n            {showSubtasks && \r\n                <RecordList \r\n                    classNames={['subtasks-list']}\r\n                    rootId={id}\r\n                />\r\n            }\r\n        </>\r\n    )\r\n}\r\n\r\nexport default memo(Record)\r\n","import { useEffect, useState } from \"react\"\r\nimport { useEvent, notify, Events } from \"../../classes/Store\"\r\nimport Task from \"../../classes/Task\"\r\nimport Editable from \"../Record/Editable\"\r\n\r\ntype Props =  {\r\n    item: Task\r\n    isEditable?: boolean\r\n}\r\n\r\nconst Title = (props: Props) => {\r\n    const { \r\n        isEditable = true,\r\n        item: { text, id }\r\n    } = props\r\n\r\n    const [ title, setTitle ] = useState('')\r\n\r\n    useEffect(() => {\r\n        setTitle(text)\r\n    }, [text])\r\n\r\n    useEvent(Events.SetTitleByProject + id, setTitle)\r\n\r\n    const updateTitle = (title: string) => {\r\n        notify(Events.SetProjectByTitle + id, title)\r\n    }\r\n\r\n    return (\r\n        <Editable \r\n            text={title} \r\n            update={updateTitle} \r\n            isEditable={isEditable}\r\n            isSingleLine={true}\r\n            classes={[ 'title' ]}\r\n        />\r\n    )\r\n}\r\n\r\nexport default Title\r\n","import { \r\n    useCallback, \r\n    useEffect, \r\n    useRef, \r\n    useState \r\n} from 'react'\r\nimport AddRecord from '../Record/AddRecord'\r\nimport Task, { Priorities } from '../../classes/Task'\r\nimport Record from '../Record/Record'\r\nimport './RecordList.scss'\r\nimport { \r\n    createTask, \r\n    deleteTask, \r\n    deleteTasks, \r\n    getSubTasksList, \r\n    getTask, \r\n    updateTask \r\n} from '../../services/taskService'\r\nimport { store, useEvent, useReload, Events } from '../../classes/Store'\r\nimport metadata from '../../classes/Metadata'\r\nimport Title from './Title'\r\n\r\ntype Props = { \r\n    classNames?: string[],\r\n    rootId: string,\r\n    hasTitle?: boolean,\r\n    isEditable?: boolean,\r\n    projectId?: string\r\n}\r\n\r\nconst RecordList = (props: Props) => {\r\n    const {\r\n        classNames = [],\r\n        rootId,\r\n        hasTitle = false,\r\n        isEditable = true,\r\n        projectId\r\n    } = props\r\n\r\n    const [root, setRoot] = useState<Task>(new Task())\r\n    const [subTasks, setSubTasks] = useState<Task[]>([])\r\n\r\n    const setData = () => {\r\n        const task = getTask(rootId)\r\n        setRoot(task)\r\n        const subTasks = getSubTasksList(rootId)\r\n        setSubTasks(subTasks)\r\n    }\r\n\r\n    const focusedItemId = useRef<string>() \r\n\r\n    useReload(setData)\r\n\r\n    useEffect(setData, [rootId])\r\n\r\n    useEffect(() => { focusedItemId.current = '' }, [rootId])\r\n\r\n    const isRootList = metadata.isRoot(rootId)\r\n\r\n    const addSubTask = useCallback((task: Task) => {\r\n        task.parentId = root.id\r\n\r\n        createTask(task)\r\n        \r\n        focusedItemId.current = task.id\r\n\r\n        const newSubTasks = subTasks.concat(task)\r\n        setSubTasks(newSubTasks)\r\n\r\n        if (isRootList) store.selectedProjectId = task.id\r\n    }, [isRootList, root.id, subTasks])\r\n\r\n    const updateSubTask = useCallback((task: Task) => {\r\n        const newSubTasks = subTasks.map((it) => {\r\n            return it.id === task.id ? task : it  \r\n        })\r\n        setSubTasks(newSubTasks)\r\n        updateTask(task)\r\n    }, [subTasks])\r\n\r\n    const deleteSubTask = useCallback((task: Task) => {\r\n        const isSelectedPojectDeleted = store.selectedProjectId === task.id\r\n        const newSubTasks = subTasks.filter((it) => it !== task)\r\n        setSubTasks(newSubTasks)\r\n        deleteTask(task.id)\r\n        if (isSelectedPojectDeleted) store.selectedProjectId = ''\r\n    }, [subTasks])\r\n\r\n    const deleteCompletedSubTask = useCallback(() => {\r\n        const idsToDelete = subTasks.filter((it) => it.isDone).map((it) => it.id)\r\n        const isSelectedPojectDeleted = idsToDelete\r\n            .some((id) => store.selectedProjectId === id)\r\n        const newSubTasks = subTasks.filter((it) => !it.isDone)\r\n        setSubTasks(newSubTasks)\r\n        deleteTasks(idsToDelete)\r\n        if (isSelectedPojectDeleted) store.selectedProjectId = ''\r\n    }, [subTasks])\r\n\r\n    useEvent(Events.DeleteCompleted + rootId, deleteCompletedSubTask)\r\n\r\n    // sort subtask by priority\r\n    const setAndComparePriotity = (a: Task, b: Task) => {\r\n        const pa = a.priority || Priorities.Trivial\r\n        const pb = b.priority || Priorities.Trivial\r\n\r\n        if (pa > pb) return -1\r\n        if (pa < pb) return 1\r\n        return 0\r\n    }\r\n    subTasks.sort(setAndComparePriotity)\r\n\r\n    const activeTasks = subTasks.filter((t) => !t.isDone)\r\n    const completedTasks = subTasks.filter((t) => t.isDone)\r\n\r\n    const activeItemListRef = useRef<HTMLDivElement>(null)\r\n\r\n    const classes = [\r\n        isRootList ? 'project-list' : 'task-list',\r\n        ...classNames\r\n    ].join(' ')\r\n\r\n    return (\r\n        <div className={classes}>\r\n            {hasTitle && \r\n                <Title\r\n                    item={root}\r\n                    isEditable={isEditable}\r\n                />\r\n            }\r\n            <div className=\"active-tasks\" ref={activeItemListRef}>\r\n                {activeTasks.map(\r\n                    (task: Task) => \r\n                        <Record \r\n                            key={task.id} \r\n                            item={task}\r\n                            isEditable={isEditable}\r\n                            isSelected={projectId === task.id}\r\n                            update={updateSubTask}\r\n                            remove={deleteSubTask}\r\n                            isFocused={focusedItemId.current === task.id}\r\n                        />\r\n                )}\r\n            </div>\r\n            <AddRecord add={addSubTask}/>\r\n            {!!completedTasks.length && <div className=\"completed-tasks\">\r\n                {completedTasks.map(\r\n                    (task: Task) => \r\n                        <Record \r\n                            key={task.id}\r\n                            item={task}\r\n                            isEditable={isEditable}\r\n                            isSelected={projectId === task.id}\r\n                            update={updateSubTask}\r\n                            remove={deleteSubTask}\r\n                        />\r\n                )}\r\n            </div>}\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default RecordList\r\n","import { useRef } from 'react'\r\nimport { useOutsideClickDetector } from '../../utils/customHooks'\r\nimport Fog from '../Fog/Fog'\r\nimport { BsBoxArrowLeft } from 'react-icons/bs'\r\nimport RecordList from '../RecordList/RecordList'\r\nimport { ROOT_ID } from '../../classes/Metadata'\r\nimport { APP_VERSION } from '../../version'\r\n\r\ntype Props = {\r\n    isOpened: boolean,\r\n    close: () => void,\r\n    isSettingsOpened: boolean,\r\n    projectId: string\r\n}\r\n\r\nconst Sidebar = (props: Props) => {\r\n    const { \r\n        isOpened, \r\n        close, \r\n        isSettingsOpened, \r\n        projectId \r\n    } = props\r\n\r\n    const leftPanelRef = useRef(null)\r\n    useOutsideClickDetector(leftPanelRef, close, isOpened) \r\n\r\n    const handleClick = (e: any) => {\r\n        const el = e.target as HTMLDivElement  \r\n              \r\n        if (el.getAttribute('contenteditable') === \"false\") close()\r\n    }\r\n\r\n    const classes = [\r\n        'left-panel',\r\n        isOpened ? 'panel-opened' : '',\r\n        isSettingsOpened? 'no-scroll' : ''\r\n    ].join(' ')\r\n\r\n    return (\r\n        <div \r\n            ref={leftPanelRef} \r\n            className={classes} \r\n            onClick={handleClick}\r\n        >\r\n            <div className=\"app-version\">v{APP_VERSION}</div>\r\n            <Fog isDisplayed={isSettingsOpened} />\r\n                <div className=\"top-panel\">\r\n                    <div className=\"row-btns\">\r\n                        <BsBoxArrowLeft \r\n                            onClick={close}\r\n                            className=\"common-btn close-menu-btn\"\r\n                            title=\"hide projects list\"\r\n                        />\r\n                    </div>\r\n                </div>\r\n            <RecordList \r\n                rootId={ROOT_ID}\r\n                hasTitle\r\n                isEditable={false}\r\n                projectId={projectId}\r\n            />\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Sidebar\r\n","export const APP_VERSION = '0.2.2'","import { useRef, useState } from 'react'\r\nimport Task from '../../classes/Task'\r\nimport { FailureBanner, SuccessBanner } from '../Banner/Banner'\r\nimport { readFile } from '../../utils/commonUtils'\r\nimport { reload, store } from '../../classes/Store'\r\nimport Portal from '../../HOCs/Portal'\r\nimport ImportModal from './ImportModal'\r\nimport Button from '../Buttons/Button'\r\nimport { \r\n    createTasks, \r\n    getAllTasks, \r\n    getTasksTree \r\n} from '../../services/taskService'\r\n\r\nenum DataTypes {\r\n    JSON = 'json',\r\n    HTML = 'html'\r\n}\r\n\r\ntype Props = {\r\n    backToTaskList(): void\r\n}\r\n\r\nconst ExportImport = (props: Props) => {\r\n    const [ showModal, setShowModal ] = useState(false)\r\n\r\n    const { backToTaskList } = props\r\n\r\n    const fileInputRef = useRef<HTMLInputElement>(null)\r\n\r\n    let dataType = DataTypes.JSON\r\n\r\n    const exportData = () => {\r\n        switch (dataType) {\r\n            case DataTypes.JSON:\r\n                exportDataAsJson()\r\n                break\r\n            case DataTypes.HTML:\r\n                exportDataAsHtml()\r\n                break\r\n            default:\r\n                exportDataAsJson()\r\n        }\r\n    }\r\n\r\n    const doImport = async () => {\r\n        let tasks: Task[] | null = null\r\n        try {\r\n            const files = fileInputRef.current?.files\r\n            if (files) {\r\n                const fileContent = await readFile(files[0])\r\n                tasks = JSON.parse(fileContent)\r\n                clearFileInput()\r\n                setShowModal(false)\r\n            }\r\n        } catch(err) {\r\n            setShowModal(false)\r\n            store.banner = new FailureBanner('Failed to parse JSON file')\r\n            clearFileInput()\r\n            return\r\n        }\r\n        if (!tasks) {\r\n            store.banner = new FailureBanner('No exported tasks found')\r\n            return\r\n        }\r\n        \r\n        createTasks(tasks)\r\n        backToTaskList()\r\n        reload()\r\n        \r\n        store.banner = new SuccessBanner('Data successfully imported', 5)\r\n    }\r\n\r\n    const clickOnFileInput = () => {\r\n        const node = fileInputRef.current!\r\n        node.click()\r\n    }\r\n\r\n    const clearFileInput = () => {\r\n        const node = fileInputRef.current!\r\n        node.value = ''\r\n    }\r\n\r\n    const setDataType = (e: any) => {\r\n        dataType = e.target.value\r\n    }\r\n\r\n    const onModalConfirm = () => {\r\n        doImport()\r\n    }\r\n\r\n    const onModalCancel = () => {\r\n        clearFileInput()\r\n        setShowModal(false)\r\n    }\r\n\r\n    return (\r\n        <div className=\"settings-block\">\r\n            <h2>Import/Export your data</h2>\r\n            <Button text='export' action={exportData} />\r\n            <span className=\"words-between\">as</span>\r\n            <select className=\"data-types-select\" onChange={setDataType}>\r\n                <option value={DataTypes.JSON}>{DataTypes.JSON.toUpperCase()}</option>\r\n                <option value={DataTypes.HTML}>{DataTypes.HTML.toUpperCase()}</option>\r\n            </select>\r\n            <Button \r\n                text='import json' \r\n                action={clickOnFileInput} \r\n                classNames={['import-btn']} \r\n            />\r\n            <input \r\n                className=\"input-hidden\" \r\n                type=\"file\" \r\n                accept=\".json\" \r\n                onChange={() => setShowModal(true)} \r\n                ref={fileInputRef} \r\n            />\r\n            {showModal && \r\n            <Portal>\r\n                <ImportModal onCancel={onModalCancel} onConfirm={onModalConfirm} />\r\n            </Portal>}\r\n        </div>\r\n    )\r\n}\r\n\r\nconst doExport = (data: string, type: DataTypes) => {\r\n    const dataToExport = `data:text/${type};charset=utf-8,${data}`\r\n    const encodedUri = encodeURI(dataToExport)\r\n    const link = document.createElement('a')\r\n    link.setAttribute('href', encodedUri)\r\n    link.setAttribute('download', getExportFileName(type));\r\n    link.click();\r\n}\r\n\r\nconst exportDataAsJson = () => {\r\n    doExport(convertDataToJsonString(), DataTypes.JSON)\r\n}\r\n\r\nconst exportDataAsHtml = () => {\r\n    const taskTree = getTasksTree()\r\n    const content = convertDataToHtmlString(taskTree)\r\n    const styles = 'body { font-family: sans-serif; font-size: 16px; } ul, li { margin-top: 6px }'\r\n    const data = `<html><head><style>${styles}</style></head><body>${content}</body></html>`\r\n    doExport(data, DataTypes.HTML)\r\n}\r\n\r\nconst convertDataToJsonString = (): string => {\r\n    return JSON.stringify(getAllTasks(), null, 2)\r\n}\r\n\r\nconst getExportFileName = (type: DataTypes) => {\r\n    const timestamp = new Date().toISOString()\r\n    return `todolist_export_${timestamp}.${type}`\r\n}\r\n\r\nconst convertDataToHtmlString = (task: Task): string => {\r\n    const textDecoration = task.isDone \r\n        ? 'style=\"text-decoration: line-through\"' \r\n        : ''\r\n\r\n    const subTasksHtml = \r\n        `<ul>${task.subTasks?.map((it) => convertDataToHtmlString(it))}</ul>`\r\n\r\n    return  `<li ${textDecoration}>${task.text + subTasksHtml}</li>`\r\n            .replace(/>,</g, '><')\r\n}\r\n\r\nexport default ExportImport\r\n","import { memo } from 'react'\r\nimport './Button.scss'\r\nimport { MdMenu } from 'react-icons/md'\r\n\r\ntype Props = {\r\n    action: () => void\r\n    classNames?: string[]\r\n    title?: string\r\n}\r\n\r\nconst MenuButton = (props: Props) => {\r\n    const {\r\n        action,\r\n        classNames = [],\r\n        title = ''\r\n    } = props\r\n\r\n    const handleClick = (e: any) => {\r\n        e.stopPropagation()\r\n        action()\r\n    }\r\n\r\n    return (\r\n        <MdMenu \r\n            className={`common-btn ${classNames.join(' ')}`} \r\n            onClick={handleClick}\r\n            title={title}\r\n        />\r\n    )\r\n}\r\n\r\nexport default memo(MenuButton)\r\n","import { useEffect } from \"react\"\r\nimport { createPortal } from \"react-dom\"\r\n\r\ntype Props = { children: any }\r\n\r\nconst Portal = ({ children }: Props) => {\r\n  const mountPoint = document.getElementById(\"portal-root\")\r\n  const el = document.createElement(\"div\")\r\n\r\n  useEffect(() => {\r\n    mountPoint!.appendChild(el)\r\n\r\n    return () => {\r\n        mountPoint!.removeChild(el)\r\n    }\r\n  }, [el, mountPoint])\r\n\r\n  return createPortal(children, el)\r\n};\r\n\r\nexport default Portal","import './withModal.scss'\r\nimport Fog from '../components/Fog/Fog'\r\n\r\nconst withModal = <P extends object>(WrapedComponent: React.ComponentType<P>) => {\r\n\r\n    return (props: any) => (\r\n        <>\r\n            <Fog isDisplayed={true} />\r\n            <div className=\"modal-container\">\r\n                <div className=\"modal-dialog\">\r\n                    <WrapedComponent {...props} />\r\n                </div>\r\n            </div>\r\n        </>\r\n    )\r\n}\r\n\r\nexport default withModal\r\n","import { forwardRef } from 'react'\r\nimport './Button.scss'\r\n\r\ntype Props = {\r\n    text: string\r\n    action: (e: any) => void\r\n    isOutlined?: boolean\r\n    classNames?: string[]\r\n}\r\n\r\nconst Button = (props: Props, ref?: React.ForwardedRef<HTMLButtonElement>) => {\r\n    const {\r\n        text,\r\n        action,\r\n        isOutlined = false,\r\n        classNames = []\r\n    } = props\r\n\r\n    const classes = [ \r\n        'button',\r\n        isOutlined ? 'outlined-btn' : 'filled-btn',\r\n        ...classNames\r\n    ].join(' ')\r\n    \r\n    return (\r\n        <button \r\n            className={classes}\r\n            onClick={action}\r\n            ref={ref}\r\n        >\r\n            {text}\r\n        </button>\r\n    )\r\n}\r\n\r\nexport default forwardRef(Button)\r\n","import withModal from \"../../HOCs/withModal\"\r\nimport { useEffect, useRef } from \"react\"\r\nimport Button from \"../Buttons/Button\"\r\n\r\ntype Props = {\r\n    onConfirm: () => void\r\n    onCancel: () => void\r\n}\r\n\r\nconst ImportModal = (props: Props) => {\r\n    const {\r\n        onConfirm,\r\n        onCancel\r\n    } = props\r\n\r\n    const cancelRef = useRef<HTMLButtonElement>(null)\r\n\r\n    useEffect(() => { setTimeout(() => cancelRef.current?.focus(), 0) })\r\n\r\n    return (\r\n        <>\r\n            <div>Do you want to overwrite existing data?</div>\r\n            <div className=\"modal-btns\">\r\n                <Button \r\n                    text='cancel' \r\n                    ref={cancelRef} \r\n                    action={onCancel} \r\n                    isOutlined\r\n                    classNames={['central-btn']}\r\n                />\r\n                <Button \r\n                    text='ok' \r\n                    action={onConfirm} \r\n                />\r\n            </div>\r\n        </>\r\n    )\r\n}\r\n\r\nexport default withModal(ImportModal)\r\n","import { useRef } from 'react'\r\nimport DropboxConnector from '../../classes/DropboxConnector'\r\nimport { FailureBanner, SuccessBanner } from '../Banner/Banner'\r\nimport syncer from '../../classes/Syncer'\r\nimport { GoArrowRight } from \"react-icons/go\";\r\nimport Button from '../Buttons/Button'\r\nimport { store } from '../../classes/Store'\r\n\r\nconst DropboxSettings = () => {\r\n    const dbx = new DropboxConnector()\r\n\r\n    const authTokenRef = useRef<HTMLInputElement>(null)\r\n\r\n    const authorizeApp = async () => {\r\n        store.showLoading = true\r\n        try {\r\n            await dbx.authorize(authTokenRef.current?.value)\r\n\r\n            syncer.init(dbx)\r\n            store.banner = new SuccessBanner('Application successfully authorized')\r\n        } catch(e) {\r\n            store.banner = new FailureBanner('Error: ' + e.message)\r\n        }\r\n        store.showLoading = false\r\n    }\r\n\r\n    return (\r\n        <>\r\n            <h3>\r\n                Connect Dropbox\r\n                {dbx.isConfigured\r\n                    ? <span className=\"is-authorized already-authorized\" title=\"Already configured\">\r\n                        &#10004;\r\n                    </span>\r\n                    : <span className=\"is-authorized not-authorized\" title=\"Not configured\">\r\n                        !\r\n                    </span>\r\n                }\r\n            </h3>\r\n            <div className=\"dropbox-flow\">\r\n                <Button text='get code' action={()=> window.open(dbx.authUrl, \"_blank\")} />\r\n                <GoArrowRight className=\"arrow-right\" />\r\n                <input \r\n                    type=\"text\" \r\n                    size={48} \r\n                    placeholder=\"insert authorizarion code here\"\r\n                    ref={authTokenRef}\r\n                    className=\"auth-code\"\r\n                />\r\n                <GoArrowRight className=\"arrow-right\" />\r\n                <Button text='authorize' action={authorizeApp} />\r\n            </div>\r\n        </>\r\n    )\r\n}\r\n\r\nexport default DropboxSettings\r\n","import { useState } from 'react'\r\nimport * as ls from '../../services/localStorageService'\r\nimport syncer, { SyncTargets } from '../../classes/Syncer'\r\nimport { SyncStatuses } from '../Statuses/SyncStatus'\r\nimport DropboxSettings from './DropboxSettings'\r\nimport { usePropertyWithState } from '../../classes/Store'\r\n\r\nfunction SyncSettings() {\r\n    const [ syncTarget, setSyncTarget ] = useState(ls.getSyncTarget())\r\n\r\n    const [ syncStatus, setSynStatus ] = usePropertyWithState('syncStatus')\r\n\r\n    const isSelectDisabled = syncStatus === SyncStatuses.InProgress\r\n\r\n    const getTargetSettingsElement = () => {\r\n        switch (syncTarget) {\r\n            case SyncTargets.Dropbox:\r\n                return <DropboxSettings />\r\n            default:\r\n                return null\r\n        }\r\n    }\r\n\r\n    const handleTargetChange = (e: any) => {\r\n        const target = e.target.value as SyncTargets\r\n\r\n        if (target === SyncTargets.Disabled) {\r\n            setSynStatus(SyncStatuses.NotConfigured)\r\n        }\r\n            \r\n        setSyncTarget(target)\r\n        ls.setSyncTarget(target)\r\n        syncer.init()\r\n    }  \r\n\r\n    return (\r\n        <div className=\"settings-block\">\r\n            <h2>Cloud Synchronization</h2>\r\n            <select \r\n                disabled={isSelectDisabled} \r\n                value={syncTarget} \r\n                onChange={handleTargetChange}\r\n            >\r\n                <option value={SyncTargets.Disabled}>Disabled</option>\r\n                <option value={SyncTargets.Dropbox}>Dropbox</option>\r\n            </select>\r\n            {getTargetSettingsElement()}\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default SyncSettings\r\n","import './Settings.scss'\r\nimport ExportImport from './ExportImport' \r\nimport SyncSettings from './SyncSettings'\r\n\r\ntype Props = {\r\n    backToTaskList(): void\r\n}\r\n\r\nconst Settings = (props: Props) => {\r\n\r\n    const { backToTaskList } = props\r\n\r\n    return (\r\n        <div className=\"settings\">\r\n            <ExportImport backToTaskList={backToTaskList} />\r\n            <div className=\"divider\" />\r\n            <SyncSettings />\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Settings\r\n","import Banner from '../Banner/Banner'\r\nimport MenuButton from '../Buttons/MenuButton'\r\nimport { RiSettingsLine } from 'react-icons/ri'\r\nimport Fog from '../Fog/Fog'\r\nimport Settings from '../Settings/Settings'\r\nimport SyncStatus from '../Statuses/SyncStatus'\r\nimport { BsBoxArrowLeft } from 'react-icons/bs'\r\nimport RecordList from '../RecordList/RecordList'\r\n\r\ntype Props = {\r\n    isSidebarOpened: boolean,\r\n    isSettingsOpened: boolean,\r\n    openSidebar: () => void,\r\n    toggleSettings: () => void,\r\n    projectId: string\r\n}\r\n\r\nconst Content = (props: Props) => {\r\n    const { \r\n        isSettingsOpened, \r\n        isSidebarOpened, \r\n        openSidebar,\r\n        toggleSettings,\r\n        projectId\r\n    } = props\r\n\r\n    return (\r\n        <div className=\"right-panel\">\r\n            <Fog isDisplayed={isSidebarOpened} />\r\n            <Banner />\r\n            <div className=\"top-panel\">\r\n                {!isSettingsOpened &&\r\n                    <div className=\"row-btns\">\r\n                        <MenuButton \r\n                            action={openSidebar} \r\n                            classNames={['open-menu-btn']}\r\n                            title=\"open projects list\"\r\n                        />\r\n                    </div>\r\n                }\r\n                <div className=\"row-btns\">\r\n                    <SyncStatus />\r\n                    {isSettingsOpened \r\n                        ? <BsBoxArrowLeft \r\n                            className=\"common-btn close settings\"\r\n                            onClick={toggleSettings}\r\n                            title=\"close settings\"\r\n                          />\r\n                        : <RiSettingsLine \r\n                            className=\"common-btn \"\r\n                            onClick={toggleSettings}\r\n                            title=\"settings\"\r\n                          />\r\n                    }\r\n                </div>\r\n            </div>\r\n            <div className=\"right-content\">\r\n                {isSettingsOpened \r\n                    ? <Settings backToTaskList={toggleSettings} />\r\n                    : projectId && <RecordList rootId={projectId} hasTitle />\r\n                }\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Content\r\n","import { useEffect, useState } from 'react'\r\nimport './MainContainer.scss'\r\nimport Loading from '../Statuses/Loading'\r\nimport syncer from '../../classes/Syncer'\r\nimport Sidebar from '../Sidebar/Sidebar'\r\nimport Content from './Content'\r\nimport { \r\n    usePropertyWithState, \r\n    useReload, \r\n    initSelectProjectId \r\n} from '../../classes/Store'\r\nimport * as ls from \"../../services/localStorageService\"\r\n\r\nconst MainContainer = () => {\r\n    const [ isSettingsOpened, setIsSettingsOpened ] = useState(false)\r\n    const [ isSidebarOpened, setIsSidebarOpened ] = useState(false)\r\n\r\n    const [ selectedProjectId, setSelectedProjectId ] \r\n        = usePropertyWithState('selectedProjectId')\r\n\r\n    useReload(() => setSelectedProjectId(initSelectProjectId()))    \r\n\r\n    useEffect(() => { syncer.init() }, [])\r\n\r\n    // useEffect(() => ls.setSelectedProjectId(selectedProjectId))\r\n\r\n    ls.setSelectedProjectId(selectedProjectId)\r\n\r\n    const toggleSettings = () => setIsSettingsOpened(!isSettingsOpened)\r\n\r\n    const openSidebar = () => {\r\n        setIsSidebarOpened(true)        \r\n        !window.iAmRunningOnMobile && window.addEventListener('resize', closeSidebar)\r\n    }\r\n\r\n    const closeSidebar = () => {\r\n        setIsSidebarOpened(false)\r\n        window.removeEventListener('resize', closeSidebar)\r\n    }\r\n\r\n    return (\r\n        <div className={`main-container${isSidebarOpened ? ' sidebar-opened' : ''}`}>   \r\n            <Loading />\r\n            <Sidebar \r\n                isOpened={isSidebarOpened} \r\n                close={closeSidebar} \r\n                isSettingsOpened={isSettingsOpened}\r\n                projectId={selectedProjectId}\r\n            />\r\n            <Content \r\n                isSettingsOpened={isSettingsOpened}\r\n                isSidebarOpened={isSidebarOpened}\r\n                toggleSettings={toggleSettings}\r\n                openSidebar={openSidebar}\r\n                projectId={selectedProjectId}\r\n            />\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default MainContainer\r\n","import MainContainer from './components/MainContainer/MainContainer';\r\nimport { isMobile } from './utils/commonUtils';\r\n\r\ndeclare global { interface Window { iAmRunningOnMobile: boolean } }\r\nwindow.iAmRunningOnMobile = isMobile()\r\n\r\nconst App = () => (\r\n    <>\r\n        <div id=\"portal-root\"></div>\r\n        <MainContainer />\r\n    </>\r\n)\r\n\r\nexport default App;\r\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://cra.link/PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(/^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://cra.link/PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then((registration) => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://cra.link/PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch((error) => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then((response) => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then((registration) => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log('No internet connection found. App is running in offline mode.');\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then((registration) => {\n        registration.unregister();\n      })\n      .catch((error) => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.scss';\nimport App from './App';\nimport * as serviceWorkerRegistration from './serviceWorkerRegistration';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorkerRegistration.register();\n"],"sourceRoot":""}